/*! inline 0.0.1 2015-03-23 */
/*   */
!function(a){a(document).ready(function(){function b(){var b=a(".tab_content").hide(),c=a("ul.tabs li");if(c.addClass("tabed"),c.first().addClass("active").show(),b.first().show(),c.on("click",function(c){c.preventDefault(),c.stopPropagation();var d=a(this),e=d.find("a").attr("href");return d.hasClass("active")||(d.addClass("active").siblings().removeClass("active"),b.hide().filter(e).fadeIn()),!1}),a(".uitabs").length>0){a(".uitabs").tabs()}}function c(a){return a.replace(/^\//,"").replace(/(index|default).[a-zA-Z]{3,4}$/,"").replace(/\/$/,"")}function d(){for(var b=0,c=arguments.length;c>b;b++){var d=arguments[b],e=a(d);if(e.scrollTop()>0)return d;e.scrollTop(1);var f=e.scrollTop()>0;if(e.scrollTop(0),f)return d}return[]}jQuery().flexslider&&a(".flexslider").flexslider({smoothHeight:!0,controlNav:!1,directionNav:!0,prevText:"&larr;",nextText:"&rarr;",selector:".slides > .slide"});var e=c(location.pathname),f=d("html","body");a("a[href*=#nav]").each(function(){var b=c(this.pathname)||e;if(e==b&&(location.hostname==this.hostname||!this.hostname)&&this.hash.replace(/#/,"")){var d=a(this.hash),g=this.hash;if(g){var h=d.offset().top;a(this).click(function(b){b.preventDefault(),a(f).animate({scrollTop:h},"slow",function(){location.hash=g})})}}}),a(".toggle-view li").click(function(){var b=a(this).children(".toggle");b.is(":hidden")?(b.slideDown("fast"),a(this).children(".toggle-title").addClass("tactive")):(b.slideUp("fast"),a(this).children(".toggle-title").removeClass("tactive"))}),b()})}(jQuery),function(a){var b=(a.browser.msie?"paste":"input")+".mask",c=void 0!=window.orientation;a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},a.fn.extend({caret:function(a,b){if(0!=this.length){if("number"==typeof a)return b="number"==typeof b?b:a,this.each(function(){if(this.setSelectionRange)this.setSelectionRange(a,b);else if(this.createTextRange){var c=this.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select()}});if(this[0].setSelectionRange)a=this[0].selectionStart,b=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var c=document.selection.createRange();a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length}return{begin:a,end:b}}},unmask:function(){return this.trigger("unmask")},mask:function(d,e){if(!d&&this.length>0){var f=a(this[0]);return f.data(a.mask.dataName)()}e=a.extend({placeholder:"_",completed:null},e);var g=a.mask.definitions,h=[],i=d.length,j=null,k=d.length;return a.each(d.split(""),function(a,b){"?"==b?(k--,i=a):g[b]?(h.push(new RegExp(g[b])),null==j&&(j=h.length-1)):h.push(null)}),this.trigger("unmask").each(function(){function f(a){for(;++a<=k&&!h[a];);return a}function l(a){for(;--a>=0&&!h[a];);return a}function m(a,b){if(!(0>a)){for(var c=a,d=f(b);k>c;c++)if(h[c]){if(!(k>d&&h[c].test(u[d])))break;u[c]=u[d],u[d]=e.placeholder,d=f(d)}r(),t.caret(Math.max(j,a))}}function n(a){for(var b=a,c=e.placeholder;k>b;b++)if(h[b]){var d=f(b),g=u[b];if(u[b]=c,!(k>d&&h[d].test(g)))break;c=g}}function o(a){var b=a.which;if(8==b||46==b||c&&127==b){var d=t.caret(),e=d.begin,g=d.end;return g-e==0&&(e=46!=b?l(e):g=f(e-1),g=46==b?f(g):g),q(e,g),m(e,g-1),!1}return 27==b?(t.val(v),t.caret(0,s()),!1):void 0}function p(a){var b=a.which,c=t.caret();if(a.ctrlKey||a.altKey||a.metaKey||32>b)return!0;if(b){c.end-c.begin!=0&&(q(c.begin,c.end),m(c.begin,c.end-1));var d=f(c.begin-1);if(k>d){var g=String.fromCharCode(b);if(h[d].test(g)){n(d),u[d]=g,r();var i=f(d);t.caret(i),e.completed&&i>=k&&e.completed.call(t)}}return!1}}function q(a,b){for(var c=a;b>c&&k>c;c++)h[c]&&(u[c]=e.placeholder)}function r(){return t.val(u.join("")).val()}function s(a){for(var b=t.val(),c=-1,d=0,f=0;k>d;d++)if(h[d]){for(u[d]=e.placeholder;f++<b.length;){var g=b.charAt(f-1);if(h[d].test(g)){u[d]=g,c=d;break}}if(f>b.length)break}else u[d]==b.charAt(f)&&d!=i&&(f++,c=d);return!a&&i>c+1?(t.val(""),q(0,k)):(a||c+1>=i)&&(r(),a||t.val(t.val().substring(0,c+1))),i?d:j}var t=a(this),u=a.map(d.split(""),function(a){return"?"!=a?g[a]?e.placeholder:a:void 0}),v=t.val();t.data(a.mask.dataName,function(){return a.map(u,function(a,b){return h[b]&&a!=e.placeholder?a:null}).join("")}),t.attr("readonly")||t.one("unmask",function(){t.unbind(".mask").removeData(a.mask.dataName)}).bind("focus.mask",function(){v=t.val();var b=s();r();var c=function(){b==d.length?t.caret(0,b):t.caret(b)};(a.browser.msie?c:function(){setTimeout(c,0)})()}).bind("blur.mask",function(){s(),t.val()!=v&&t.change()}).bind("keydown.mask",o).bind("keypress.mask",p).bind(b,function(){setTimeout(function(){t.caret(s(!0))},0)}),s()})}})}(jQuery),function(a,b){"use strict";var c,d,e=a,f=e.document,g=e.navigator,h=e.setTimeout,i=e.encodeURIComponent,j=e.ActiveXObject,k=e.Error,l=e.Number.parseInt||e.parseInt,m=e.Number.parseFloat||e.parseFloat,n=e.Number.isNaN||e.isNaN,o=e.Math.round,p=e.Date.now,q=e.Object.keys,r=e.Object.defineProperty,s=e.Object.prototype.hasOwnProperty,t=e.Array.prototype.slice,u=function(){var a=function(a){return a};if("function"==typeof e.wrap&&"function"==typeof e.unwrap)try{var b=f.createElement("div"),c=e.unwrap(b);1===b.nodeType&&c&&1===c.nodeType&&(a=e.unwrap)}catch(d){}return a}(),v=function(a){return t.call(a,0)},w=function(){var a,c,d,e,f,g,h=v(arguments),i=h[0]||{};for(a=1,c=h.length;c>a;a++)if(null!=(d=h[a]))for(e in d)s.call(d,e)&&(f=i[e],g=d[e],i!==g&&g!==b&&(i[e]=g));return i},x=function(a){var b,c,d,e;if("object"!=typeof a||null==a)b=a;else if("number"==typeof a.length)for(b=[],c=0,d=a.length;d>c;c++)s.call(a,c)&&(b[c]=x(a[c]));else{b={};for(e in a)s.call(a,e)&&(b[e]=x(a[e]))}return b},y=function(a,b){for(var c={},d=0,e=b.length;e>d;d++)b[d]in a&&(c[b[d]]=a[b[d]]);return c},z=function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},A=function(a){if(a)for(var b in a)s.call(a,b)&&delete a[b];return a},B=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument))do{if(a===b)return!0;a=a.parentNode}while(a);return!1},C=function(a){var b;return"string"==typeof a&&a&&(b=a.split("#")[0].split("?")[0],b=a.slice(0,a.lastIndexOf("/")+1)),b},D=function(a){var b,c;return"string"==typeof a&&a&&(c=a.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]?b=c[1]:(c=a.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),c&&c[1]&&(b=c[1]))),b},E=function(){var a,b;try{throw new k}catch(c){b=c}return b&&(a=b.sourceURL||b.fileName||D(b.stack)),a},F=function(){var a,c,d;if(f.currentScript&&(a=f.currentScript.src))return a;if(c=f.getElementsByTagName("script"),1===c.length)return c[0].src||b;if("readyState"in c[0])for(d=c.length;d--;)if("interactive"===c[d].readyState&&(a=c[d].src))return a;return"loading"===f.readyState&&(a=c[c.length-1].src)?a:(a=E())?a:b},G=function(){var a,c,d,e=f.getElementsByTagName("script");for(a=e.length;a--;){if(!(d=e[a].src)){c=null;break}if(d=C(d),null==c)c=d;else if(c!==d){c=null;break}}return c||b},H=function(){var a=C(F())||G()||"";return a+"ZeroClipboard.swf"},I={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,unavailable:null,deactivated:null,overdue:null,ready:null},J="11.0.0",K={},L={},M=null,N={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate","flash-overdue":"Flash communication was established but NOT within the acceptable time limit"}},O={swfPath:H(),trustedDomains:a.location.host?[a.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},P=function(a){if("object"==typeof a&&null!==a)for(var b in a)if(s.call(a,b))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(b))O[b]=a[b];else if(null==I.bridge)if("containerId"===b||"swfObjectId"===b){if(!cb(a[b]))throw new Error("The specified `"+b+"` value is not valid as an HTML4 Element ID");O[b]=a[b]}else O[b]=a[b];{if("string"!=typeof a||!a)return x(O);if(s.call(O,a))return O[a]}},Q=function(){return{browser:y(g,["userAgent","platform","appName"]),flash:z(I,["bridge"]),zeroclipboard:{version:Fb.version,config:Fb.config()}}},R=function(){return!!(I.disabled||I.outdated||I.unavailable||I.deactivated)},S=function(a,b){var c,d,e,f={};if("string"==typeof a&&a)e=a.toLowerCase().split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)s.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&Fb.on(c,a[c]);if(e&&e.length){for(c=0,d=e.length;d>c;c++)a=e[c].replace(/^on/,""),f[a]=!0,K[a]||(K[a]=[]),K[a].push(b);if(f.ready&&I.ready&&Fb.emit({type:"ready"}),f.error){var g=["disabled","outdated","unavailable","deactivated","overdue"];for(c=0,d=g.length;d>c;c++)if(I[g[c]]===!0){Fb.emit({type:"error",name:"flash-"+g[c]});break}}}return Fb},T=function(a,b){var c,d,e,f,g;if(0===arguments.length)f=q(K);else if("string"==typeof a&&a)f=a.split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)s.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&Fb.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,""),g=K[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return Fb},U=function(a){var b;return b="string"==typeof a&&a?x(K[a])||null:x(K)},V=function(a){var b,c,d;return a=db(a),a&&!jb(a)?"ready"===a.type&&I.overdue===!0?Fb.emit({type:"error",name:"flash-overdue"}):(b=w({},a),ib.call(this,b),"copy"===a.type&&(d=pb(L),c=d.data,M=d.formatMap),c):void 0},W=function(){if("boolean"!=typeof I.ready&&(I.ready=!1),!Fb.isFlashUnusable()&&null===I.bridge){var a=O.flashLoadTimeout;"number"==typeof a&&a>=0&&h(function(){"boolean"!=typeof I.deactivated&&(I.deactivated=!0),I.deactivated===!0&&Fb.emit({type:"error",name:"flash-deactivated"})},a),I.overdue=!1,nb()}},X=function(){Fb.clearData(),Fb.blur(),Fb.emit("destroy"),ob(),Fb.off()},Y=function(a,b){var c;if("object"==typeof a&&a&&"undefined"==typeof b)c=a,Fb.clearData();else{if("string"!=typeof a||!a)return;c={},c[a]=b}for(var d in c)"string"==typeof d&&d&&s.call(c,d)&&"string"==typeof c[d]&&c[d]&&(L[d]=c[d])},Z=function(a){"undefined"==typeof a?(A(L),M=null):"string"==typeof a&&s.call(L,a)&&delete L[a]},$=function(a){return"undefined"==typeof a?x(L):"string"==typeof a&&s.call(L,a)?L[a]:void 0},_=function(a){if(a&&1===a.nodeType){c&&(xb(c,O.activeClass),c!==a&&xb(c,O.hoverClass)),c=a,wb(a,O.hoverClass);var b=a.getAttribute("title")||O.title;if("string"==typeof b&&b){var d=mb(I.bridge);d&&d.setAttribute("title",b)}var e=O.forceHandCursor===!0||"pointer"===yb(a,"cursor");Cb(e),Bb()}},ab=function(){var a=mb(I.bridge);a&&(a.removeAttribute("title"),a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.top="1px"),c&&(xb(c,O.hoverClass),xb(c,O.activeClass),c=null)},bb=function(){return c||null},cb=function(a){return"string"==typeof a&&a&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(a)},db=function(a){var b;if("string"==typeof a&&a?(b=a,a={}):"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(b=a.type),b){!a.target&&/^(copy|aftercopy|_click)$/.test(b.toLowerCase())&&(a.target=d),w(a,{type:b.toLowerCase(),target:a.target||c||null,relatedTarget:a.relatedTarget||null,currentTarget:I&&I.bridge||null,timeStamp:a.timeStamp||p()||null});var e=N[a.type];return"error"===a.type&&a.name&&e&&(e=e[a.name]),e&&(a.message=e),"ready"===a.type&&w(a,{target:null,version:I.version}),"error"===a.type&&(/^flash-(disabled|outdated|unavailable|deactivated|overdue)$/.test(a.name)&&w(a,{target:null,minimumVersion:J}),/^flash-(outdated|unavailable|deactivated|overdue)$/.test(a.name)&&w(a,{version:I.version})),"copy"===a.type&&(a.clipboardData={setData:Fb.setData,clearData:Fb.clearData}),"aftercopy"===a.type&&(a=qb(a,M)),a.target&&!a.relatedTarget&&(a.relatedTarget=eb(a.target)),a=fb(a)}},eb=function(a){var b=a&&a.getAttribute&&a.getAttribute("data-clipboard-target");return b?f.getElementById(b):null},fb=function(a){if(a&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)){var c=a.target,d="_mouseover"===a.type&&a.relatedTarget?a.relatedTarget:b,g="_mouseout"===a.type&&a.relatedTarget?a.relatedTarget:b,h=Ab(c),i=e.screenLeft||e.screenX||0,j=e.screenTop||e.screenY||0,k=f.body.scrollLeft+f.documentElement.scrollLeft,l=f.body.scrollTop+f.documentElement.scrollTop,m=h.left+("number"==typeof a._stageX?a._stageX:0),n=h.top+("number"==typeof a._stageY?a._stageY:0),o=m-k,p=n-l,q=i+o,r=j+p,s="number"==typeof a.movementX?a.movementX:0,t="number"==typeof a.movementY?a.movementY:0;delete a._stageX,delete a._stageY,w(a,{srcElement:c,fromElement:d,toElement:g,screenX:q,screenY:r,pageX:m,pageY:n,clientX:o,clientY:p,x:o,y:p,movementX:s,movementY:t,offsetX:0,offsetY:0,layerX:0,layerY:0})}return a},gb=function(a){var b=a&&"string"==typeof a.type&&a.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(b)},hb=function(a,b,c,d){d?h(function(){a.apply(b,c)},0):a.apply(b,c)},ib=function(a){if("object"==typeof a&&a&&a.type){var b=gb(a),c=K["*"]||[],d=K[a.type]||[],f=c.concat(d);if(f&&f.length){var g,h,i,j,k,l=this;for(g=0,h=f.length;h>g;g++)i=f[g],j=l,"string"==typeof i&&"function"==typeof e[i]&&(i=e[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(j=i,i=i.handleEvent),"function"==typeof i&&(k=w({},a),hb(i,j,[k],b))}return this}},jb=function(a){var b=a.target||c||null,e="swf"===a._source;delete a._source;var f=["flash-disabled","flash-outdated","flash-unavailable","flash-deactivated","flash-overdue"];switch(a.type){case"error":-1!==f.indexOf(a.name)&&w(I,{disabled:"flash-disabled"===a.name,outdated:"flash-outdated"===a.name,unavailable:"flash-unavailable"===a.name,deactivated:"flash-deactivated"===a.name,overdue:"flash-overdue"===a.name,ready:!1});break;case"ready":var g=I.deactivated===!0;w(I,{disabled:!1,outdated:!1,unavailable:!1,deactivated:!1,overdue:g,ready:!g});break;case"beforecopy":d=b;break;case"copy":var h,i,j=a.relatedTarget;!L["text/html"]&&!L["text/plain"]&&j&&(i=j.value||j.outerHTML||j.innerHTML)&&(h=j.value||j.textContent||j.innerText)?(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",h),i!==h&&a.clipboardData.setData("text/html",i)):!L["text/plain"]&&a.target&&(h=a.target.getAttribute("data-clipboard-text"))&&(a.clipboardData.clearData(),a.clipboardData.setData("text/plain",h));break;case"aftercopy":Fb.clearData(),b&&b!==vb()&&b.focus&&b.focus();break;case"_mouseover":Fb.focus(b),O.bubbleEvents===!0&&e&&(b&&b!==a.relatedTarget&&!B(a.relatedTarget,b)&&kb(w({},a,{type:"mouseenter",bubbles:!1,cancelable:!1})),kb(w({},a,{type:"mouseover"})));break;case"_mouseout":Fb.blur(),O.bubbleEvents===!0&&e&&(b&&b!==a.relatedTarget&&!B(a.relatedTarget,b)&&kb(w({},a,{type:"mouseleave",bubbles:!1,cancelable:!1})),kb(w({},a,{type:"mouseout"})));break;case"_mousedown":wb(b,O.activeClass),O.bubbleEvents===!0&&e&&kb(w({},a,{type:a.type.slice(1)}));break;case"_mouseup":xb(b,O.activeClass),O.bubbleEvents===!0&&e&&kb(w({},a,{type:a.type.slice(1)}));break;case"_click":d=null,O.bubbleEvents===!0&&e&&kb(w({},a,{type:a.type.slice(1)}));break;case"_mousemove":O.bubbleEvents===!0&&e&&kb(w({},a,{type:a.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)?!0:void 0},kb=function(a){if(a&&"string"==typeof a.type&&a){var b,c=a.target||null,d=c&&c.ownerDocument||f,g={view:d.defaultView||e,canBubble:!0,cancelable:!0,detail:"click"===a.type?1:0,button:"number"==typeof a.which?a.which-1:"number"==typeof a.button?a.button:d.createEvent?0:1},h=w(g,a);c&&d.createEvent&&c.dispatchEvent&&(h=[h.type,h.canBubble,h.cancelable,h.view,h.detail,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget],b=d.createEvent("MouseEvents"),b.initMouseEvent&&(b.initMouseEvent.apply(b,h),b._source="js",c.dispatchEvent(b)))}},lb=function(){var a=f.createElement("div");return a.id=O.containerId,a.className=O.containerClass,a.style.position="absolute",a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px",a.style.zIndex=""+Db(O.zIndex),a},mb=function(a){for(var b=a&&a.parentNode;b&&"OBJECT"===b.nodeName&&b.parentNode;)b=b.parentNode;return b||null},nb=function(){var a,b=I.bridge,c=mb(b);if(!b){var d=ub(e.location.host,O),g="never"===d?"none":"all",h=sb(O),i=O.swfPath+rb(O.swfPath,O);c=lb();var j=f.createElement("div");c.appendChild(j),f.body.appendChild(c);var k=f.createElement("div"),l="activex"===I.pluginType;k.innerHTML='<object id="'+O.swfObjectId+'" name="'+O.swfObjectId+'" width="100%" height="100%" '+(l?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+i+'"')+">"+(l?'<param name="movie" value="'+i+'"/>':"")+'<param name="allowScriptAccess" value="'+d+'"/><param name="allowNetworking" value="'+g+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+h+'"/></object>',b=k.firstChild,k=null,u(b).ZeroClipboard=Fb,c.replaceChild(b,j)}return b||(b=f[O.swfObjectId],b&&(a=b.length)&&(b=b[a-1]),!b&&c&&(b=c.firstChild)),I.bridge=b||null,b},ob=function(){var a=I.bridge;if(a){var b=mb(a);b&&("activex"===I.pluginType&&"readyState"in a?(a.style.display="none",function c(){if(4===a.readyState){for(var d in a)"function"==typeof a[d]&&(a[d]=null);a.parentNode&&a.parentNode.removeChild(a),b.parentNode&&b.parentNode.removeChild(b)}else h(c,10)}()):(a.parentNode&&a.parentNode.removeChild(a),b.parentNode&&b.parentNode.removeChild(b))),I.ready=null,I.bridge=null,I.deactivated=null}},pb=function(a){var b={},c={};if("object"==typeof a&&a){for(var d in a)if(d&&s.call(a,d)&&"string"==typeof a[d]&&a[d])switch(d.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":b.text=a[d],c.text=d;break;case"text/html":case"html":case"air:html":case"flash:html":b.html=a[d],c.html=d;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":b.rtf=a[d],c.rtf=d}return{data:b,formatMap:c}}},qb=function(a,b){if("object"!=typeof a||!a||"object"!=typeof b||!b)return a;var c={};for(var d in a)if(s.call(a,d)){if("success"!==d&&"data"!==d){c[d]=a[d];continue}c[d]={};var e=a[d];for(var f in e)f&&s.call(e,f)&&s.call(b,f)&&(c[d][b[f]]=e[f])}return c},rb=function(a,b){var c=null==b||b&&b.cacheBust===!0;return c?(-1===a.indexOf("?")?"?":"&")+"noCache="+p():""},sb=function(a){var b,c,d,f,g="",h=[];if(a.trustedDomains&&("string"==typeof a.trustedDomains?f=[a.trustedDomains]:"object"==typeof a.trustedDomains&&"length"in a.trustedDomains&&(f=a.trustedDomains)),f&&f.length)for(b=0,c=f.length;c>b;b++)if(s.call(f,b)&&f[b]&&"string"==typeof f[b]){if(d=tb(f[b]),!d)continue;if("*"===d){h.length=0,h.push(d);break}h.push.apply(h,[d,"//"+d,e.location.protocol+"//"+d])}return h.length&&(g+="trustedOrigins="+i(h.join(","))),a.forceEnhancedClipboard===!0&&(g+=(g?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof a.swfObjectId&&a.swfObjectId&&(g+=(g?"&":"")+"swfObjectId="+i(a.swfObjectId)),g},tb=function(a){if(null==a||""===a)return null;if(a=a.replace(/^\s+|\s+$/g,""),""===a)return null;var b=a.indexOf("//");a=-1===b?a:a.slice(b+2);var c=a.indexOf("/");return a=-1===c?a:-1===b||0===c?null:a.slice(0,c),a&&".swf"===a.slice(-4).toLowerCase()?null:a||null},ub=function(){var a=function(a){var b,c,d,e=[];if("string"==typeof a&&(a=[a]),"object"!=typeof a||!a||"number"!=typeof a.length)return e;for(b=0,c=a.length;c>b;b++)if(s.call(a,b)&&(d=tb(a[b]))){if("*"===d){e.length=0,e.push("*");break}-1===e.indexOf(d)&&e.push(d)}return e};return function(b,c){var d=tb(c.swfPath);null===d&&(d=b);var e=a(c.trustedDomains),f=e.length;if(f>0){if(1===f&&"*"===e[0])return"always";if(-1!==e.indexOf(b))return 1===f&&b===d?"sameDomain":"always"}return"never"}}(),vb=function(){try{return f.activeElement}catch(a){return null}},wb=function(a,b){if(!a||1!==a.nodeType)return a;if(a.classList)return a.classList.contains(b)||a.classList.add(b),a;if(b&&"string"==typeof b){var c=(b||"").split(/\s+/);if(1===a.nodeType)if(a.className){for(var d=" "+a.className+" ",e=a.className,f=0,g=c.length;g>f;f++)d.indexOf(" "+c[f]+" ")<0&&(e+=" "+c[f]);a.className=e.replace(/^\s+|\s+$/g,"")}else a.className=b}return a},xb=function(a,b){if(!a||1!==a.nodeType)return a;if(a.classList)return a.classList.contains(b)&&a.classList.remove(b),a;if("string"==typeof b&&b){var c=b.split(/\s+/);if(1===a.nodeType&&a.className){for(var d=(" "+a.className+" ").replace(/[\n\t]/g," "),e=0,f=c.length;f>e;e++)d=d.replace(" "+c[e]+" "," ");a.className=d.replace(/^\s+|\s+$/g,"")}}return a},yb=function(a,b){var c=e.getComputedStyle(a,null).getPropertyValue(b);return"cursor"!==b||c&&"auto"!==c||"A"!==a.nodeName?c:"pointer"},zb=function(){var a,b,c,d=1;return"function"==typeof f.body.getBoundingClientRect&&(a=f.body.getBoundingClientRect(),b=a.right-a.left,c=f.body.offsetWidth,d=o(b/c*100)/100),d},Ab=function(a){var b={left:0,top:0,width:0,height:0};if(a.getBoundingClientRect){var c,d,g,h=a.getBoundingClientRect();"pageXOffset"in e&&"pageYOffset"in e?(c=e.pageXOffset,d=e.pageYOffset):(g=zb(),c=o(f.documentElement.scrollLeft/g),d=o(f.documentElement.scrollTop/g));var i=f.documentElement.clientLeft||0,j=f.documentElement.clientTop||0;b.left=h.left+c-i,b.top=h.top+d-j,b.width="width"in h?h.width:h.right-h.left,b.height="height"in h?h.height:h.bottom-h.top}return b},Bb=function(){var a;if(c&&(a=mb(I.bridge))){var b=Ab(c);w(a.style,{width:b.width+"px",height:b.height+"px",top:b.top+"px",left:b.left+"px",zIndex:""+Db(O.zIndex)})}},Cb=function(a){I.ready===!0&&(I.bridge&&"function"==typeof I.bridge.setHandCursor?I.bridge.setHandCursor(a):I.ready=!1)},Db=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;return"number"!=typeof a||n(a)?"string"==typeof a&&(b=Db(l(a,10))):b=a,"number"==typeof b?b:"auto"},Eb=function(a){function b(a){var b=a.match(/[\d]+/g);return b.length=3,b.join(".")}function c(a){return!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a)||"chrome.plugin"===a.slice(-13))}function d(a){a&&(i=!0,a.version&&(l=b(a.version)),!l&&a.description&&(l=b(a.description)),a.filename&&(k=c(a.filename)))}var e,f,h,i=!1,j=!1,k=!1,l="";if(g.plugins&&g.plugins.length)e=g.plugins["Shockwave Flash"],d(e),g.plugins["Shockwave Flash 2.0"]&&(i=!0,l="2.0.0.11");else if(g.mimeTypes&&g.mimeTypes.length)h=g.mimeTypes["application/x-shockwave-flash"],e=h&&h.enabledPlugin,d(e);else if("undefined"!=typeof a){j=!0;try{f=new a("ShockwaveFlash.ShockwaveFlash.7"),i=!0,l=b(f.GetVariable("$version"))}catch(n){try{f=new a("ShockwaveFlash.ShockwaveFlash.6"),i=!0,l="6.0.21"}catch(o){try{f=new a("ShockwaveFlash.ShockwaveFlash"),i=!0,l=b(f.GetVariable("$version"))}catch(p){j=!1}}}}I.disabled=i!==!0,I.outdated=l&&m(l)<m(J),I.version=l||"0.0.0",I.pluginType=k?"pepper":j?"activex":i?"netscape":"unknown"};Eb(j);var Fb=function(){return this instanceof Fb?void("function"==typeof Fb._createClient&&Fb._createClient.apply(this,v(arguments))):new Fb};r(Fb,"version",{value:"2.1.6",writable:!1,configurable:!0,enumerable:!0}),Fb.config=function(){return P.apply(this,v(arguments))},Fb.state=function(){return Q.apply(this,v(arguments))},Fb.isFlashUnusable=function(){return R.apply(this,v(arguments))},Fb.on=function(){return S.apply(this,v(arguments))},Fb.off=function(){return T.apply(this,v(arguments))},Fb.handlers=function(){return U.apply(this,v(arguments))},Fb.emit=function(){return V.apply(this,v(arguments))},Fb.create=function(){return W.apply(this,v(arguments))},Fb.destroy=function(){return X.apply(this,v(arguments))},Fb.setData=function(){return Y.apply(this,v(arguments))},Fb.clearData=function(){return Z.apply(this,v(arguments))},Fb.getData=function(){return $.apply(this,v(arguments))},Fb.focus=Fb.activate=function(){return _.apply(this,v(arguments))},Fb.blur=Fb.deactivate=function(){return ab.apply(this,v(arguments))},Fb.activeElement=function(){return bb.apply(this,v(arguments))};var Gb=0,Hb={},Ib=0,Jb={},Kb={};w(O,{autoActivate:!0});var Lb=function(a){var b=this;b.id=""+Gb++,Hb[b.id]={instance:b,elements:[],handlers:{}},a&&b.clip(a),Fb.on("*",function(a){return b.emit(a)}),Fb.on("destroy",function(){b.destroy()}),Fb.create()},Mb=function(a,b){var c,d,e,f={},g=Hb[this.id]&&Hb[this.id].handlers;if("string"==typeof a&&a)e=a.toLowerCase().split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)s.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&this.on(c,a[c]);if(e&&e.length){for(c=0,d=e.length;d>c;c++)a=e[c].replace(/^on/,""),f[a]=!0,g[a]||(g[a]=[]),g[a].push(b);if(f.ready&&I.ready&&this.emit({type:"ready",client:this}),f.error){var h=["disabled","outdated","unavailable","deactivated","overdue"];for(c=0,d=h.length;d>c;c++)if(I[h[c]]){this.emit({type:"error",name:"flash-"+h[c],client:this});break}}}return this},Nb=function(a,b){var c,d,e,f,g,h=Hb[this.id]&&Hb[this.id].handlers;if(0===arguments.length)f=q(h);else if("string"==typeof a&&a)f=a.split(/\s+/);else if("object"==typeof a&&a&&"undefined"==typeof b)for(c in a)s.call(a,c)&&"string"==typeof c&&c&&"function"==typeof a[c]&&this.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,""),g=h[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return this},Ob=function(a){var b=null,c=Hb[this.id]&&Hb[this.id].handlers;return c&&(b="string"==typeof a&&a?c[a]?c[a].slice(0):[]:x(c)),b},Pb=function(a){if(Ub.call(this,a)){"object"==typeof a&&a&&"string"==typeof a.type&&a.type&&(a=w({},a));var b=w({},db(a),{client:this});Vb.call(this,b)}return this},Qb=function(a){a=Wb(a);for(var b=0;b<a.length;b++)if(s.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===Jb[a[b].zcClippingId].indexOf(this.id)&&Jb[a[b].zcClippingId].push(this.id):(a[b].zcClippingId="zcClippingId_"+Ib++,Jb[a[b].zcClippingId]=[this.id],O.autoActivate===!0&&Xb(a[b]));var c=Hb[this.id]&&Hb[this.id].elements;-1===c.indexOf(a[b])&&c.push(a[b])}return this},Rb=function(a){var b=Hb[this.id];if(!b)return this;var c,d=b.elements;a="undefined"==typeof a?d.slice(0):Wb(a);for(var e=a.length;e--;)if(s.call(a,e)&&a[e]&&1===a[e].nodeType){for(c=0;-1!==(c=d.indexOf(a[e],c));)d.splice(c,1);var f=Jb[a[e].zcClippingId];if(f){for(c=0;-1!==(c=f.indexOf(this.id,c));)f.splice(c,1);0===f.length&&(O.autoActivate===!0&&Yb(a[e]),delete a[e].zcClippingId)}}return this},Sb=function(){var a=Hb[this.id];return a&&a.elements?a.elements.slice(0):[]},Tb=function(){this.unclip(),this.off(),delete Hb[this.id]},Ub=function(a){if(!a||!a.type)return!1;if(a.client&&a.client!==this)return!1;var b=Hb[this.id]&&Hb[this.id].elements,c=!!b&&b.length>0,d=!a.target||c&&-1!==b.indexOf(a.target),e=a.relatedTarget&&c&&-1!==b.indexOf(a.relatedTarget),f=a.client&&a.client===this;return d||e||f?!0:!1},Vb=function(a){if("object"==typeof a&&a&&a.type){var b=gb(a),c=Hb[this.id]&&Hb[this.id].handlers["*"]||[],d=Hb[this.id]&&Hb[this.id].handlers[a.type]||[],f=c.concat(d);if(f&&f.length){var g,h,i,j,k,l=this;for(g=0,h=f.length;h>g;g++)i=f[g],j=l,"string"==typeof i&&"function"==typeof e[i]&&(i=e[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(j=i,i=i.handleEvent),"function"==typeof i&&(k=w({},a),hb(i,j,[k],b))}return this}},Wb=function(a){return"string"==typeof a&&(a=[]),"number"!=typeof a.length?[a]:a},Xb=function(a){if(a&&1===a.nodeType){var b=function(a){(a||(a=e.event))&&("js"!==a._source&&(a.stopImmediatePropagation(),a.preventDefault()),delete a._source)},c=function(c){(c||(c=e.event))&&(b(c),Fb.focus(a))};a.addEventListener("mouseover",c,!1),a.addEventListener("mouseout",b,!1),a.addEventListener("mouseenter",b,!1),a.addEventListener("mouseleave",b,!1),a.addEventListener("mousemove",b,!1),Kb[a.zcClippingId]={mouseover:c,mouseout:b,mouseenter:b,mouseleave:b,mousemove:b}}},Yb=function(a){if(a&&1===a.nodeType){var b=Kb[a.zcClippingId];if("object"==typeof b&&b){for(var c,d,e=["move","leave","enter","out","over"],f=0,g=e.length;g>f;f++)c="mouse"+e[f],d=b[c],"function"==typeof d&&a.removeEventListener(c,d,!1);delete Kb[a.zcClippingId]}}};Fb._createClient=function(){Lb.apply(this,v(arguments))},Fb.prototype.on=function(){return Mb.apply(this,v(arguments))},Fb.prototype.off=function(){return Nb.apply(this,v(arguments))},Fb.prototype.handlers=function(){return Ob.apply(this,v(arguments))},Fb.prototype.emit=function(){return Pb.apply(this,v(arguments))},Fb.prototype.clip=function(){return Qb.apply(this,v(arguments))},Fb.prototype.unclip=function(){return Rb.apply(this,v(arguments))},Fb.prototype.elements=function(){return Sb.apply(this,v(arguments))},Fb.prototype.destroy=function(){return Tb.apply(this,v(arguments))},Fb.prototype.setText=function(a){return Fb.setData("text/plain",a),this},Fb.prototype.setHtml=function(a){return Fb.setData("text/html",a),this},Fb.prototype.setRichText=function(a){return Fb.setData("application/rtf",a),this},Fb.prototype.setData=function(){return Fb.setData.apply(this,v(arguments)),this},Fb.prototype.clearData=function(){return Fb.clearData.apply(this,v(arguments)),this},Fb.prototype.getData=function(){return Fb.getData.apply(this,v(arguments))},"function"==typeof define&&define.amd?define(function(){return Fb}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=Fb:a.ZeroClipboard=Fb}(function(){return this||window}()),function(a){a.chai={ini:function(b){return a.chai.ready(b)},core:{}}}(jQuery),function(a){a.chai.core.util={autosaved:!1,t:null,autoSaver:function(){a.chai.core.util.t=window.setInterval(function(){a.each(a("form.autosave"),function(){var b=a(this);a(".dialog_message.autosave").length<=0&&a("body").append("<div class='dialog_message ui-state-highlight autosave'>"),a(".dialog_message.autosave").html("Auto saving"),a(".dialog_message.autosave").show(),a.ajax({url:a(this).attr("action"),data:"autosave=true&autosaved="+a.chai.core.util.autosaved+"&"+a(this).serialize(),type:"POST",success:function(c){if(a(".dialog_message.autosave").removeClass("ui-state-error"),c&&"success"===c)a.chai.core.util.autosaved=!0,a(".dialog_message.autosave").html("Auto saved form"),b.trigger("reinitialize.areYouSure"),a(".dialog_message.autosave").show(),setTimeout(function(){a(".dialog_message.autosave").fadeOut("500")},"1000");else{if(c&&"unsaved"===c)return window.clearInterval(a.chai.core.util.t),a.chai.core.util.t=null,a(".dialog_message.autosave").html("Will not auto save untill the item is saved."),a(".dialog_message.autosave").show(),void setTimeout(function(){a(".dialog_message.autosave").fadeOut("500")},"4000");a(".dialog_message.autosave").addClass("ui-state-error"),a(".dialog_message.autosave").html("Failed to auto save.  Will try again in 10sec."),a(".dialog_message.autosave").show(),setTimeout(function(){a(".dialog_message.autosave").fadeOut("500")},"4000")}},statusCode:{500:function(){window.clearInterval(a.chai.core.util.t),a.chai.core.util.t=null,a(".dialog_message.autosave").addClass("ui-state-error"),a(".dialog_message.autosave").html("Failed to auto save - 500 error"),a(".dialog_message.autosave").show(),setTimeout(function(){a(".dialog_message.autosave").fadeOut("500")},"4000")}}})})},1e4)},start_autoSaver:function(){a("form.autosave").areYouSure({silent:!0,change:function(){a(this).hasClass("dirty")?a.chai.core.util.autoSaver():(window.clearInterval(a.chai.core.util.t),a.chai.core.util.t=null)}})},unhighlight:function(){a(".highlighted").animate({"background-color":"#FFF"},1500,function(){a(this).removeClass("highlighted")
})},alais_scruber:function(a,b){var c=a.val();c=c.split(" ").join("-"),c=c.split("&").join("-and-"),c=c.replace(/[^A-Za-z0-9\-_]/g,""),c=c.split("--").join("-"),c=c.split("__").join("_"),c=c.split("/").join(""),b.val(c.toLowerCase())},turnon_alias:function(b,c){b.off().on("keyup",function(){a.chai.core.util.alais_scruber(b,c)})},make_maskes:function(){a.mask.definitions["~"]="[+-]",a('[type="date"],[rel="date"]').mask("99/99/9999",{completed:function(){}}),a("#tab_date").mask("9999",{completed:function(){}}),a("input").blur(function(){}).dblclick(function(){a(this).unmask()}),a("label i[title]").tooltip(),a('[type="date"],[rel="date"]').datepicker()},set_up_list_deletion:function(){a(".deletion").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this);a.chai.core.util.confirmation_message("Are you sure you want send this item to the trashbin?",{yes:function(){window.location=c.attr("href")},no:function(){}})})},setup_viewlog:function(){a("#viewlog").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.get("/center/retriveLog.castle",{id:a(this).data("item_id")},function(b){a("#view_log_area").length<=0&&a("body").append('<div id="view_log_area">'),a("#view_log_area").html(b),a("#view_log_area").dialog({autoOpen:!0,resizable:!1,width:.8*a(window).width(),height:.8*a(window).height(),modal:!0,draggable:!1,buttons:{Close:function(){a(this).dialog("close")}},create:function(){a("body").css({overflow:"hidden"})},close:function(){a.chai.core.util.close_dialog_modle(a("#view_log_area"))}})})})},setup_refs:function(){a(".add_ref").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this).closest(".datagrid").dataTable({aaSorting:[[1,"asc"]],order:[],columnDefs:[{targets:"no-sort",orderable:!1}]});c.dataTable().fnAddData(["$part.baseid",'<input type="hidden" name="references[$count].baseid" value="$part.baseid" class="drug_item"/>$part.type',"$part.name",'<a href="$item.url" class="ref_link"><i class="icon-external-link"></i></a>',"$item.note",'<a href="substance.castle?id=$part.baseid" class="button small inline_edit" data-type="substance">Edit</a> | <a href="#" class="button xsmall crimson defocus removal">Remove</a>']),a.chai.core.util.setup_ref_copy()})},setup_ref_copy:function(){a.each(a(".ref_text:not(.cp_ready)"),function(){var b=this;a(b).on("click",function(a){a.preventDefault(),a.stopPropagation()});var c=new ZeroClipboard(b);c.on("ready",function(){a(b).addClass("cp_ready"),c.on("aftercopy",function(a){alert("Copied text to clipboard: "+a.data["text/plain"])})})})},setting_item_pub:function(b){b.find(".pubstate").buttonset(),b.find(".pubstate :radio:checked").val()<1?b.find("#noting").next("label").show():b.find("#noting").next("label").hide(),b.find(".pubstate :radio").change(function(){b.find(".pubstate :radio").next("label").find("i").removeClass("icon-check-empty").removeClass("icon-check"),b.find(".pubstate :radio").not(":checked").next("label").find("i").addClass("icon-check-empty"),b.find(".pubstate :radio:checked").next("label").find("i").addClass("icon-check"),b.find(".pubstate :radio:checked").val()<1?b.find("#noting").next("label").show():b.find("#noting").next("label").hide(),b.find("#noting").next("label").find("i").addClass(""!==b.find(".notearea").find("textarea").val()?"icon-file-text-alt":"icon-file-alt")}),b.find("#noting").button(),b.find("#noting").change(function(){b.find(".notearea").dialog({autoOpen:!0,height:300,width:350,modal:!0,buttons:{"CLEAR Note":function(){a(this).find("textarea").val(""),a(this).dialog("close")},Accept:function(){a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}},close:function(){b.find(".noted").find("label").removeClass("ui-state-active");var c=a(this).find("textarea").val();b.find("[name='item.content']").val(c),b.find("#noting").attr("checked",!1),b.find("#noting").next("label").find("i").removeClass("icon-file-text-alt").removeClass("icon-file-alt"),b.find("#noting").next("label").find("i").addClass(""!==c?"icon-file-text-alt":"icon-file-alt"),a(this).dialog("destroy")}})})},popup_message:function(b,c){"undefined"==typeof c&&(c=!1),a("#mess").length<=0&&a("body").append('<div id="mess">'),a("#mess").html("string"==typeof b||b instanceof String?b:b.html()),a("#mess").dialog({autoOpen:!0,resizable:!1,width:350,minHeight:25,modal:!0,draggable:!1,create:function(){c&&(a(".ui-dialog-titlebar").remove(),a(".ui-dialog-buttonpane").remove()),a("body").css({overflow:"hidden"})},buttons:{Ok:function(){a(this).dialog("close")}},close:function(){a.chai.core.util.close_dialog_modle(a("#mess"))}})},confirmation_message:function(b,c){a("#mess").length<=0&&a("body").append('<div id="mess">'),a("#mess").html("string"==typeof b||b instanceof String?b:b.html()),a("#mess").dialog({autoOpen:!0,resizable:!1,width:350,minHeight:25,modal:!0,draggable:!1,create:function(){a(".ui-dialog-titlebar").remove(),a("body").css({overflow:"hidden"})},buttons:{Yes:function(){a.isFunction(c.yes)&&c.yes(),a(this).dialog("close")},No:function(){a.isFunction(c.no)&&c.no(),a(this).dialog("close")}},close:function(){a.chai.core.util.close_dialog_modle(a("#mess"))}})},add_item_popup:function(b,c,d,e){"undefined"==typeof d&&(d=["new","list"]),0===a("#drug_form").length&&a("#staging").append("<div id='drug_form'><div id='drug_list'></div><div id='drug_item'></div></div>");var f="";a.ajax({cache:!1,url:"/center/"+b+"s.castle",data:{skiplayout:1,exclude:c,typed_ref:a('[name="typed_ref"]').val()},success:function(g){a.inArray("list",d)>-1&&(a("#drug_list").html(g),f+="<a href='#drug_list' id='drug_list_tab' class='popuptab button med active'>List</a>"),a.ajax({cache:!1,url:"/center/"+b+".castle",data:{skiplayout:1,id:"undefined"==typeof e?"":e,typed_ref:a('[name="typed_ref"]').val()},success:function(e){a.inArray("new",d)>-1&&(a("#drug_item").html(e),f+="<a href='#drug_item' id='drug_item_tab' class='popuptab button med'>New</a>"),a("#drug_form").dialog({autoOpen:!0,resizable:!1,width:a(window).width()-50,height:a(window).height()-50,modal:!0,draggable:!1,buttons:{Cancel:function(){a(this).dialog("close")}},create:function(){a("#mess").dialog("destroy"),a("#mess").remove(),""!==a("#drug_item").html()&&""!==a("#drug_list").html()&&(a("#drug_form").closest(".ui-dialog").find(".ui-dialog-title").append(f),a("#drug_item").hide()),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),a("#drug_list").html().length>0&&a.chai.core.util.make_popup_datatable(b),a(".popuptab").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(".popuptab.active").attr("href");a(c).hide(),a(".popuptab.active").removeClass("active"),a(this).addClass("active"),c=a(this).attr("href"),a(c).show()}),a.chai.core.util.set_up_form(b,c,d),a.chai.clinical.activate_adverse_ui()},close:function(){a.chai.core.util.close_dialog_modle(a("#drug_form")),a.chai.core.util.last_datatable=null}}),a.chai.core.util.set_diamodle_resizing(a("#drug_form"))}})}})},set_diamodle_resizing:function(b){a(window).resize(function(){b.dialog("option",{width:a(window).width()-50,height:a(window).height()-50})})},close_dialog_modle:function(b){b.dialog("destroy"),b.remove(),a(".ui-dialog.ui-widget.ui-widget-content").length<=0&&a("body").css({overflow:"auto"})},moa_dmpk_setup:function(){a.each(a(".has_moa_dmpk:not(.activated)"),function(){var b=a(this);a(this).addClass("activated");var c=b.closest(".moa_dmpk_block").find(".moa_dmpk");""===b.val()&&c.hide(),b.on("keyup",function(){""===b.val()?(c.find(":selected").attr("selected",!1),c.hide()):c.show()})})},apply_a_taxed_add:function(b,c,d){a("a.tax_add").on("click",function(e){e.preventDefault(),e.stopPropagation(),a.chai.core.util.start_taxed_add(b,c,d)})},start_taxed_add:function(b,c,d){"undefined"===c&&(c=a(a(this).data("select"))),a("#taxonomyitem").length<=0&&a("body").append("<div id='taxonomyitem'>");var e=a("#taxonomyitem");"undefined"===b&&(b=a(this).data("type")),a.ajax({cache:!1,url:"/admin/edit_taxonomy.castle",data:{skiplayout:1,type:b},success:function(b){e.html(b),e.dialog({autoOpen:!0,resizable:!1,modal:!0,draggable:!1,create:function(){a("body").css({overflow:"hidden"}),a("#taxonomyitem .ui-dialog-buttonpane").remove(),e.find('input[name$=".alias"]').closest("p").css({display:"none"})},open:function(){a.chai.core.util.turnon_alias(e.find('input[name$=".name"]'),e.find('input[name$=".alias"]')),"undefined"==typeof d&&a.chai.core.util.make_a_tax_form(c,function(){a.chai.core.util.alais_scruber(e.find('input[name$=".name"]'),e.find('input[name$=".alias"]'))}),"function"==typeof d&&d(c)},close:function(){a.chai.core.util.close_dialog_modle(a("#taxonomyitem"))}}),a(window).resize(function(){var b=.25*a(window).width(),c=.25*a(window).height();a("#taxonomyitem").dialog("option",{width:b,height:c})})}})},make_tax_form:function(b,c,d){var e=a("#taxonomyitem form");e.find('[type="submit"]').on("click",function(f){if(f.preventDefault(),f.stopPropagation(),a("#taxonomyitem form").on("change",function(){var b=!0;a.each(a("input,select"),function(){""!==a(this).not(":hidden").val()&&""!==a(this).not(":hidden").find(":selected").val()&&(b=!1)}),a('#taxonomyitem form input[name="empty"]').val(b+"")}),!e.find('input[name="empty"]').val()){"undefined"!=typeof c&&c();var g=e.find("input, textarea, select").serializeArray();a.ajax({cache:!1,url:"/admin/update_taxonomy.castle?ajax=true",data:g,dataType:"json",success:function(c){if(""!==c.alias){var e='<option value="'+c.alias+'" '+(b.is(d)?"selected":"")+" "+(b.is(d)?"selected":"")+' data=" -- '+c.alias+'" selected>'+c.name+"</option>";b.is(".adverse_events")&&(e='<option value="'+c.baseid+'" data-baseid="'+c.baseid+'" data-alias="'+c.alias+'" data-content=""  selected >'+c.name+"</option>"),b.find(".add").before(e),a("#taxonomyitem").dialog("destroy"),a("#taxonomyitem").remove(),a.chai.core.util.popup_message(a("<span><h5>You have added a  new taxonomy!</h5>It has also selected for you</span>")),b.is(".adverse_events")&&(b.find(':selected:not([value="'+c.baseid+'"])').removeAttr("selected"),b.trigger("change")),a('form[name="entry_form"] :input:first').trigger("click")}else a.chai.core.util.popup_message(a("<span>failed to save, try again.</span>"))}})}})},make_a_tax_form:function(b,c){var d=a("#taxonomyitem form");a("#taxonomyitem form").on("change",function(){var b=!0;a.each(a("input,select"),function(){""!==a(this).not(":hidden").val()&&""!==a(this).not(":hidden").find(":selected").val()&&(b=!1)}),a('#taxonomyitem form input[name="empty"]').val(b+"")}),d.find('[type="submit"]').on("click",function(e){if(e.preventDefault(),e.stopPropagation(),!d.find('input[name="empty"]').val()){"function"==typeof c&&c();var f=d.find("input, textarea, select").serializeArray();a.ajax({cache:!1,url:"/center/update_taxonomy.castle?ajax=true",data:f,dataType:"json",success:function(c){""!==c.alias?("function"==typeof b&&b(c),"undefined"!=typeof b&&"function"!=typeof b&&b.find("option:first").before('<option value="'+c.alias+'" selected>'+c.name+"</option>"),a("#taxonomyitem").dialog("destroy"),a("#taxonomyitem").remove(),a.chai.core.util.popup_message(a("<span><h5>You have added a  new taxonomy!</h5>It has also selected for you</span>")),a('form[name="entry_form"] :input:first').trigger("change")):a.chai.core.util.popup_message(a("<span>failed to save, try again.</span>"))}})}})},apply_tax_request:function(){a.each(a(".requested_taxed:not(.activated)"),function(){var b=a(this);b.addClass("activated"),b.find(".add").length<=0&&b.find("option:last").after('<option value="" class="add">Request new option</option>')}),a(".requested_taxed").on("change",function(){var b=a(this),c=a(this).find("option:selected");if(c.hasClass("add")){c.removeAttr("selected"),a("#taxonomyitem").length<=0&&a("body").append("<div id='taxonomyitem'>");var d='<h3>Make a request for a new item</h3><lable>Name:</lable><input type="text" value=""/><br/><br/><input type="submit" value="Subbmit Request"/>',e=a("#taxonomyitem");e.html(d),e.dialog({autoOpen:!0,resizable:!1,width:450,modal:!0,draggable:!1,create:function(){a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),e.find('input[name$=".alias"]').closest("p").css({display:"none"}),a.chai.core.util.make_tax_form(b,function(){a.chai.core.util.alais_scruber(e.find('input[name$=".name"]'),e.find('input[name$=".alias"]'))})},open:function(){a.chai.core.util.turnon_alias(e.find('input[name$=".name"]'),e.find('input[name$=".alias"]'))},close:function(){a.chai.core.util.close_dialog_modle(a("#taxonomyitem"))}})}})},apply_taxed_add:function(){a.each(a(".taxed:not(.activated)"),function(){var b=a(this);b.addClass("activated"),b.find(".add").length<=0&&b.find("option:last").after('<option value="" class="add">Add new option</option>')}),a(".taxed").on("change",function(){var b=a(this),c=a(this).find("option:selected");if(c.hasClass("add")){c.removeAttr("selected"),a("#taxonomyitem").length<=0&&a("body").append("<div id='taxonomyitem'>");var d,e=a("#taxonomyitem"),f=b.attr("rel"),g=b.attr("id"),h=""!==f&&"undefined"!=typeof f?f:g,i=b.attr("rel");"undefined"!=typeof i&&i!==!1&&(d=a('[rel="'+h+'"]')),a.ajax({cache:!1,url:"/admin/edit_taxonomy.castle",data:{skiplayout:1,type:h},success:function(c){e.html(c),e.dialog({autoOpen:!0,resizable:!1,modal:!0,draggable:!1,create:function(){a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),e.find('input[name$=".alias"]').closest("p").css({display:"none"}),a.chai.core.util.make_tax_form(b,function(){a.chai.core.util.alais_scruber(e.find('input[name$=".name"]'),e.find('input[name$=".alias"]'))},d)},open:function(){a.chai.core.util.turnon_alias(e.find('input[name$=".name"]'),e.find('input[name$=".alias"]'))},close:function(){a.chai.core.util.close_dialog_modle(a("#taxonomyitem"))}}),a(window).resize(function(){a("#taxonomyitem").dialog("option",{width:.25*a(window).width(),height:.25*a(window).height()})})}})}})},get_table_ids:function(b){var c="",d=b.dataTable().fnGetNodes();return a.each(d,function(b,d){var e=a(d).find("input.list_item");c+=(""===c?"":",")+e.val()}),c},get_select_ids:function(b){var c="";return a.each(b.find("option"),function(){c+=(""===c?"":",")+a(this).val()}),c},set_up_form:function(b){a.chai.core.util.make_maskes(),a.chai.core.util.moa_dmpk_setup(),a.chai.core.util.apply_tax_request(),a.chai.core.util.apply_taxed_add(),a.chai.core.util.setting_item_pub(a(".ui-dialog")),a('input[name^="post"]').val(a('input[name="item.baseid"]').val()),a("#load_file").on("click",function(){a(".load_file").toggleClass("active")}),a("#drug_form [type='submit']").on("click",function(c){var d=a(this).closest("form");d.find(":invalid").length<=0&&(c.preventDefault(),c.stopPropagation(),a.post(d.attr("action")+"?skiplayout=1&ajaxed_update=1",d.serialize(),function(){a("#drug_form").dialog("destroy"),a("#drug_form").remove(),a(".add_to_list[data-type='"+b+"']").trigger("click")}))})},ini_modaltable_to_table:function(b,c){a(".additem").off().on("click",function(d){d.preventDefault(),d.stopPropagation();var e=a(this),f=e.closest("tr"),g=f.data("baseid"),h=b.find("tbody").find("tr").length+1;"reference"===c&&(h=a(".main .ref.dataTable tbody tr").length+1,a(".main .ref.dataTable tbody tr td.dataTables_empty").length&&h--);var i=f.find("td").length,j=[],k=("reference"===c?"":"item.")+c+"s["+(h-1)+"].baseid",l=f.find("td:first").text()+'<input type="hidden" name="'+k+'" value="'+g+'" class="drug_item list_item"/>';j.push(l),j.push(f.find("td:first").next("td").text()),i>3&&j.push(f.find("td:first").next("td").next("td").text()),i>4&&j.push(f.find("td:first").next("td").next("td").next("td").text());var m;if("reference"===c){var n=f.find("td:first").text();m='<button class="ref_text" data-clipboard-text="#{{REF '+n+'}}" title="Click to copy me.">Copy Ref</button>'}j.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'+m),"reference"===c?a('.main .ref.dataTable [value="'+g+'"]').length<=0&&(a(".main .ref.dataTable").dataTable().fnAddData(j),a('.main .ref.dataTable [value="'+g+'"]').closest("tr").find("td:eq(2),td:eq(3)").addClass("no_overflow")):a('[data-active_grid="true"] [value="'+g+'"]').length<=0&&a("[data-active_grid='true']").dataTable().fnAddData(j),f.fadeOut("75",function(){b.fnDeleteRow(b.fnGetPosition(f.get(0)))}),a("#drug_form").append("<span class='dialog_message ui-state-highlight'>Added to this "+a("#header_title").text()+"</span>"),setTimeout(function(){a(".dialog_message").fadeOut("500")},"1000"),"reference"===c&&a.chai.core.util.setup_ref_copy(),a("ul .display.datagrid.dataTable .removal").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this);a.chai.core.util.confirmation_message("Are you sure?",{yes:function(){a.chai.core.util.remove_datatable_current_row(c)},no:function(){}})})})},last_datatable:null,make_popup_datatable:function(b){a.each(a(".datagrid:not(.dataTable)"),function(){var c=a(this);c.dataTable({bJQueryUI:!0,sPaginationType:"full_numbers",fnDrawCallback:function(){a.chai.core.util.ini_modaltable_to_table(c,b)},order:[],columnDefs:[{targets:"no-sort",orderable:!1}]}),c.on("draw.dt",function(){a.chai.core.util.ini_modaltable_to_table(c,b)}),a.chai.core.util.last_datatable=c,a.chai.core.util.ini_modaltable_to_table(c,b)})},make_dataTables:function(){if(a(".datagrid:not(.dataTable)").length){var b=a(".datagrid:not(.dataTable)");a.each(b,function(){var c=a(this);c.dataTable({bJQueryUI:!0,sPaginationType:"full_numbers",aaSorting:[[1,"asc"]],order:[],columnDefs:[{targets:"no-sort",orderable:!1}]}),c.on("draw.dt",function(){a.chai.core.util.ini_modaltable_to_table(c,b.closest(".dataTables_wrapper").next(".add_to_list").data("type")),a.chai.core.util.ini_dataTable_removals(c.find(".removal")),a.chai.core.util.set_up_list_deletion()})});var c=a(".add_to_list");a.each(c,function(){var b=a(this);b.on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.data("type"),e=c.prev(".dataTables_wrapper").find(".datagrid");a("[data-active_grid='true']").attr("data-active_grid",!1),e.attr("data-active_grid",!0);var f="";e.find(".dataTables_empty").length<=0&&(f=a.chai.core.util.get_table_ids(e)),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> loading ... </span>',!0),a.chai.core.util.add_item_popup(d,f,["new","list"])})}),a.chai.core.util.set_up_list_deletion(),a.chai.core.util.ini_dataTable_removals()}},ini_dataTable_removals:function(b){b=b||a(".display.datagrid.dataTable .removal"),a.each(b,function(){a.chai.core.util.build_general_removal_button(a(this))})},build_general_removal_button:function(b){b.off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this);a.chai.core.util.confirmation_message("Are you sure?",{yes:function(){a.chai.core.util.remove_datatable_current_row(c)},no:function(){}})})},remove_datatable_current_row:function(a){var b=a.closest("tr"),c=a.closest("table").dataTable();b.fadeOut("75",function(){var a=b.get(0);c.fnDeleteRow(c.fnGetPosition(a))})}}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{a=decodeURIComponent(a.replace(g," "))}catch(b){return}try{return h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setDate(k.getDate()+j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),function(a){a.fn.areYouSure=function(b){var c=a.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:!1,addRemoveFieldsMarksDirty:!1,fieldEvents:"change keyup propertychange input",fieldSelector:":input:not(input[type=submit]):not(input[type=button])"},b),d=function(b){if(b.hasClass("ays-ignore")||b.hasClass("aysIgnore")||b.attr("data-ays-ignore")||void 0===b.attr("name"))return null;if(b.is(":disabled"))return"ays-disabled";var c,d=b.attr("type");switch(b.is("select")&&(d="select"),d){case"checkbox":case"radio":c=b.is(":checked");break;case"select":c="",b.find("option").each(function(){var b=a(this);b.is(":selected")&&(c+=b.val())});break;default:c=b.val()}return c},e=function(a){a.data("ays-orig",d(a))},f=function(b){var e=function(a){var b=a.data("ays-orig");return void 0===b?!1:d(a)!==b},f=a(this).is("form")?a(this):a(this).parents("form");if(e(a(b.target)))return void h(f,!0);var g=f.find(c.fieldSelector);if(c.addRemoveFieldsMarksDirty){var i=f.data("ays-orig-field-count");if(i!==g.length)return void h(f,!0)}var j=!1;g.each(function(){var b=a(this);return e(b)?(j=!0,!1):void 0}),h(f,j)},g=function(b){var d=b.find(c.fieldSelector);a(d).each(function(){e(a(this))}),a(d).unbind(c.fieldEvents,f),a(d).bind(c.fieldEvents,f),b.data("ays-orig-field-count",a(d).length),h(b,!1)},h=function(a,b){var d=b!==a.hasClass(c.dirtyClass);a.toggleClass(c.dirtyClass,b),d&&(c.change&&c.change.call(a,a),b&&a.trigger("dirty.areYouSure",[a]),b||a.trigger("clean.areYouSure",[a]),a.trigger("change.areYouSure",[a]))},i=function(){var b=a(this),d=b.find(c.fieldSelector);a(d).each(function(){var b=a(this);b.data("ays-orig")||(e(b),b.bind(c.fieldEvents,f))}),b.trigger("checkform.areYouSure")},j=function(){g(a(this))};return c.silent||window.aysUnloadSet||(window.aysUnloadSet=!0,a(window).bind("beforeunload",function(){var b=a("form").filter("."+c.dirtyClass);if(0!==b.length){if(window.navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return c.message}})),this.each(function(){if(a(this).is("form")){var b=a(this);b.submit(function(){b.removeClass(c.dirtyClass)}),b.bind("reset",function(){h(b,!1)}),b.bind("rescan.areYouSure",i),b.bind("reinitialize.areYouSure",j),b.bind("checkform.areYouSure",f),g(b)}})}}(jQuery),$.fn.hideOptionGroup=function(){$.each($(this),function(){var a=$(this),b=a.attr("label"),c=a.closest("select").attr("name"),d=$("select").index(a.closest("select"));a.attr("data-pname",c),$("."+b+"_contaner_"+d).length<=0&&$("body").append("<select style='position:absolute;top:-9999em;left:-9999em;' class='"+b+"_contaner_"+d+"'><select>");var e=$("."+b+"_contaner_"+d);a.children().each(function(){$(this).removeAttr("selected")}),a.appendTo(e)})},$.fn.showOptionGroup=function(){$.each($(this),function(){var a=$(this).data("pname");$(this).appendTo($("select[name='"+a+"']"))})},function(a){a(document).ready(function(){a("#viewonly").change(function(){var b=a("#viewonly:checked").length;a.cookie("hivviewonly",1===b?"true":"false",{expires:1,path:"/"}),window.location=window.location.href}),a(".pubstate").buttonset(),a(".pubstate.menuaction :radio").on("change",function(){a(".pubstate :radio").attr("checked",!1).removeAttr("checked").next("label").removeClass("ui-state-active"),a(this).attr("checked",!0),a(".pubstate :radio").next("label").find("i").removeClass("icon-check-empty").removeClass("icon-check"),a(".pubstate :radio").not(":checked").next("label").find("i").addClass("icon-check-empty"),a(".pubstate :radio:checked").next("label").addClass("ui-state-active").find("i").addClass("icon-check");var b=a('.pubstate [name="pub"]:checked').val(),c=a('[name="trash"]').is(":checked");c||a.cookie("hivpubview",1===c?"":1===b?"true":"false",{expires:1,path:"/"}),window.location=window.location.href.split("?")[0]+"?"+(c?"&trash=1":"&pub="+b)}),a.chai.core.util.setting_item_pub(a(".container")),a(".message.ui-state-highlight").length&&setTimeout(function(){a(".message.ui-state-highlight").fadeOut(500)},2e3)})}(jQuery),function(a){a.chai.form_base={ini:function(){a.chai.core.util.start_autoSaver(),a.chai.core.util.moa_dmpk_setup(),a.chai.core.util.make_maskes(),a.chai.core.util.setup_refs(),a.chai.core.util.apply_tax_request(),a.chai.core.util.apply_taxed_add(),a.chai.core.util.apply_a_taxed_add(),a.chai.clinical.activate_adverse_ui(),a.chai.core.util.make_dataTables(),a("option.add_item").on("click",function(b){b.preventDefault(),b.stopPropagation(),a(this).attr("selected",!1),a.chai.core.util.add_item_popup(a(this).closest("select").data("type"),a.chai.core.util.get_select_ids(a(this).closest("select")),["new"])}),a(".inline_edit").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> </span>',!0),a.chai.core.util.add_item_popup(a(this).data("type"),"",["new"],a(this).closest("tr").data("baseid"))}),a(".help_block").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#"+a(this).data("block"));c.is(":visible")?c.hide():c.show()})}}}(jQuery),function(a){a.chai.family={ini:function(){a.chai.core.util.setup_viewlog(),a.chai.form_base.ini(),a.chai.trial.start_popup_watch(),a.chai.family.start_popup_watch(),a("#substances_disabled").on("click",function(b){b.preventDefault(),b.stopPropagation(),a("#substances_disabled_mess").length<=0&&a("body").append('<div id="substances_disabled_mess">'),a("#substances_disabled_mess").html(a(this).attr("title")),a("#substances_disabled_mess").dialog({autoOpen:!0,resizable:!1,width:350,minHeight:25,modal:!0,draggable:!1,create:function(){a(".ui-dialog-titlebar").remove(),a("body").css({overflow:"hidden"})},open:function(){},buttons:{Ok:function(){a(this).dialog("close"),window.location="/center/substance.castle"}},close:function(){a.chai.core.util.close_dialog_modle(a("#substances_disabled_mess"))}})}),a("#sortable").sortable({handle:".sortable_handle",placeholder:"ui-state-highlight",stop:function(){a.chai.family.sortedCode()}}),a("#famSubAdd").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.getJSON("/center/substances.castle?json=true&callback=?",function(b){var c="";a.each(b,function(b,d){a('[name="substances['+d.baseid+'].baseid"]').length<=0&&(c+="<span class='item i"+b+"' data-baseid='"+d.baseid+"' data-name='"+d.name+"' data-abbreviated='"+d.abbreviated+"'  ><i title='edit' class='icon-plus'></i>"+d.name+" ( "+d.abbreviated+" )<br/></span>")}),""===c&&(c="There are no substances to use."),a("#substances_list").length<=0&&a("body").append('<div id="substances_list">'),a("#substances_list").html(c),a("#substances_list").dialog({autoOpen:!0,resizable:!1,width:350,minHeight:25,modal:!0,draggable:!1,create:function(){a(".ui-dialog-titlebar").remove(),a("body").css({overflow:"hidden"})},open:function(){a(".item .icon-plus").on("click",function(){var b=a(this).closest("span");b.fadeOut("fast");var c="<li class='substance_item'>";c+="<i title='edit' class='icon-trash'></i>",c+="<span class='sortable_handle'>handle</span> "+b.data("name")+" (<span class='sub_code'>"+b.data("abbreviated")+"</span>)",c+="<input type='hidden' name='substances["+b.data("baseid")+"].baseid' value='"+b.data("baseid")+"' class='substance'/>",c+="<input type='hidden' name='family_substance["+b.data("baseid")+"].baseid' value='0'  class=''/>",c+="<input type='hidden' name='family_substance["+b.data("baseid")+"].family.baseid' value='"+a('[name="item.baseid"]').val()+"'  class=''/>",c+="<input type='hidden' name='family_substance["+b.data("baseid")+"].substance_order' value='"+a(".substance_item").length+"'  class='substanceOrder'/>",c+="<input type='hidden' name='family_substance["+b.data("baseid")+"].substance.baseid' value='"+b.data("baseid")+"'  class=''/>",c+="</li>",a(c).appendTo("#sortable"),a("#sortable").sortable("refresh"),a.chai.family.sortedCode()})},buttons:{Ok:function(){a(this).dialog("close")}},close:function(){a.chai.core.util.close_dialog_modle(a("#substances_list"))}})})}),a("#famSubCode .icon-edit").on("click",function(){a("#subCodeEdit").is(a(".open"))?a("#subCodeEdit").slideUp("slow",function(){a("#subCodeEdit").removeClass("open"),a("#subCodeEdit").addClass("closed")}):a("#subCodeEdit").slideDown("slow",function(){a("#subCodeEdit").addClass("open"),a("#subCodeEdit").removeClass("closed")})}),a("#subCodeEdit .icon-power-off").on("click",function(){a("#subCodeEdit").slideUp("slow",function(){a("#subCodeEdit").removeClass("open"),a("#subCodeEdit").addClass("closed")})}),a.chai.family.sortedCode(),a.chai.drug.setup_ddi_ui(),a.each(a('.drpro_table:not(".dataTable")'),function(){var b=a(this);b.DataTable({bJQueryUI:!0,sPaginationType:"full_numbers",order:[],columnDefs:[{targets:"no-sort",orderable:!1}],fnDrawCallback:function(){a("#drpro_table").find(".drpro_table .dataTables_empty").html('No drug products available. <a href="#" class="add_drPro">Add <i title="edit" class="icon-plus"></i></a>'),a("#drpro_table").find(".add_drPro").off().on("click",function(b){b.preventDefault(),b.stopPropagation(),a.chai.family.add_drProTableRow()}),a("#drpro_table").find(".removal").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this);a.chai.core.util.confirmation_message("Are you sure?",{yes:function(){a.chai.core.util.remove_datatable_current_row(c)},no:function(){}})})}})})},start_popup_watch:function(){a(".drug_inline_edit").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> Loading content...</span>',!0);var c=a(this).data("baseid")||a(this).closest("tr").data("baseid");a.chai.drug.drug_popupForm(c)})},sortedCode:function(){a(".substance_item .icon-trash").off().on("click",function(){a(this).closest(".substance_item").fadeOut("fast",function(){a(this).remove(),a.chai.family.sortedCode()})});var b="";a.each(a(".substance_item"),function(c){b+=(""===b?"":"<em>:</em>")+a(this).find(".sub_code").text(),a(this).find(".substanceOrder").val(c+1)}),a("#sub_code").html(b)},add_drProTableRow:function(){var b="";b+="<div id='drPro_additions' class='min'>",b+="<h4>Create new Drug</h4>",b+="<div id='create_drPros_stub' class='full-input'>",b+="<form action='/center/savedrug.castle' method='post'><input name='item.baseid' type='hidden' value='0'>",b+="<input type='hidden' name='item.families.substance_id' value='"+a("[name='item.baseid']").val()+"'/>";var c=a("#drug_forms").html();b+="Form: "+c+"<!--<input type='text' name='item.dose_form' value='' style='display: inline-block; max-width:50%;'/>-->",b+="<input type='hidden' name='item.attached' value='false'/>",b+="<label>Unit <select name='item.dose_unit' style='display: inline-block; max-width:50%;'><option value=''>Select Unit</option><option value='mg'>mg</option><option value='mg/ml'>mg/ml</option></select></label>",b+="<label>Amounts<br/>",a.each(a(".substance_item"),function(){b+="<span style='min-width:20%'>"+a(this).find(".sub_code").text()+":</span> <input type='text' class='sub_label_claim' style='width: auto; display: inline-block; max-width: 100%;' /><br/>"}),b+="</label>",b+="<input type='hidden' name='label_claim'/><br/>",b+="<label>Manufacturer<br/><select name='item.manufacturer' id='quick_drPro_manufacturer'><option value=''>Select</option></select><br/></label>",b+="</form>",b+="</div>",b+="</div>",b+="<div class='clearfix'></div>",a("#form_list").length<=0&&a("body").append('<div id="form_list">'),a("#form_list").html(b),a("#form_list").dialog({autoOpen:!0,resizable:!1,width:350,minHeight:150,height:"auto",maxHeight:a(window).height(),modal:!0,draggable:!1,create:function(){a(".ui-dialog-titlebar").remove(),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonset").prepend("<a href='#' id='create_drPros_stub_submit' class='button'>Add drug product stub</a>")
},open:function(){a.getJSON("/center/get_taxonomies.castle?tax=commercial&callback=?",function(b){var c="";a.each(b,function(a,b){c+="<option value='"+b.alias+"'>"+b.name+"</option>"}),a("#quick_drPro_manufacturer").append(c)}),a("#create_drPros_stub_submit").on("click",function(b){b.preventDefault(),b.stopPropagation();var c="";a.each(a(".sub_label_claim"),function(b){b>0&&(c+=":"),c+=a.trim(a(this).val())}),a('[name="label_claim"]').val(c),a('[name="label_claim"]').val(c);var d=a("#create_drPros_stub form").find("input, textarea, select").serializeArray();a.ajax({cache:!1,url:a("#create_drPros_stub form").attr("action")+"?json=true&ajaxed_update=true&callback=?",data:d,dataType:"json",success:function(b){""!==b.baseid?(a.chai.core.util.popup_message(a("<span><h5>You have added a new Durg Protuct!</h5> It was added to the table of products for the drug form.</span>")),a("#drpro_empty").remove(),a('[href="#existing_drPros"]').trigger("click"),a.each(b,function(b,c){var d=a("#drpro_table").find(".dataTable"),e=[],f=a(".drug_item.list_item").length;e.push(c.form),a.each(c.label_claim.split(":"),function(a,b){e.push(b)}),e.push(c.manufacturer),e.push('<input type="hidden" name="drugs['+f+'].baseid" value="'+c.baseid+'" class="drug_item list_item"/><a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),d.dataTable().fnAddData(e),a.chai.core.util.build_general_removal_button(a("ul .display.datagrid.dataTable .removal"))}),a.chai.core.util.autoSaver(),a("#form_list").dialog("close")):a.chai.core.util.popup_message(a("<span>failed to save, try again.</span>"))}})})},buttons:{Close:function(){a(this).dialog("close")}},close:function(){a.chai.core.util.close_dialog_modle(a("#form_list"))}})}}}(jQuery),function(a){a.chai.markets={ui:{tabs:null,tabTitle:null,tabTemplate:null,tabCounter:null},ini:function(){a.chai.markets.ui.tabs=a("#tabed").tabs().addClass("ui-tabs-vertical ui-helper-clearfix"),a(".ui-state-default span.ui-icon-close").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this).closest("li").remove().attr("aria-controls");a("#"+c).remove(),a.chai.markets.ui.tabs.tabs("refresh"),a.each(a('input[name^="markets_counts["]'),function(b){a(this).attr("name","markets_counts["+(b+1)+"]")})}),a("#tabed li").removeClass("ui-corner-top").addClass("ui-corner-left"),a("#newyear").on("click",function(b){b.preventDefault(),b.stopPropagation(),a("#marketdialog").length<=0&&a("body").append('<div id="marketdialog" title="Tab data"><form><fieldset class="ui-helper-reset"><label for="tab_title">Year</label><input type="number" name="tab_date" id="tab_date" value="" class="ui-widget-content ui-corner-all" /></fieldset></form></div>'),a.chai.markets.ui.tabTitle=a("#tab_date"),a.chai.markets.ui.tabTemplate="<li><a href='#{href}'>#{label}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>",a.chai.markets.ui.tabCounter=a("#tabed li").length;var c=new Date,d=a("#marketdialog").dialog({autoOpen:!0,modal:!0,create:function(){a.chai.core.util.make_maskes(),a("#tab_date").spinner({min:1980,max:c.getFullYear()+2,create:function(){a("#tab_date").spinner("value",c.getFullYear())},change:function(){a("#tab_date").val()>c.getFullYear()+2&&(a("#marketdialog").append('<p style="display:block; background-color:yellow; color:red; padding: 2px 5px;" id="yearWarning">You reached the max year. Reseting the year for you.</p>'),setTimeout(function(){a("#yearWarning").fadeOut(500)},2e3),a("#tab_date").val(c.getFullYear()+2))}})},buttons:{Add:function(){a.chai.markets.addTab(),a(this).dialog("close")},Cancel:function(){a(this).dialog("close")}},close:function(){e[0].reset()}}),e=d.find("form").submit(function(b){a.chai.markets.addTab(),d.dialog("close"),b.preventDefault()});a.chai.markets.ui.tabs.delegate("span.ui-icon-close","click",function(){var b=a(this).closest("li").remove().attr("aria-controls");a("#"+b).remove(),a.chai.markets.ui.tabs.tabs("refresh"),a.each(a('input[name^="markets_counts["]'),function(b){a(this).attr("name","markets_counts["+(b+1)+"]")})}),a.chai.markets.ui.tabs.bind("keyup",function(b){if(b.altKey&&b.keyCode===a.ui.keyCode.BACKSPACE){var c=a.chai.markets.ui.tabs.find(".ui-tabs-active").remove().attr("aria-controls");a("#"+c).remove(),a.chai.markets.ui.tabs.tabs("refresh")}})})},addTab:function(){var b=a.chai.markets.ui.tabTitle.val()||"Tab "+a.chai.markets.ui.tabCounter,c="tabs-"+a.chai.markets.ui.tabCounter,d=a(a.chai.markets.ui.tabTemplate.replace(/#\{href\}/g,"#"+c).replace(/#\{label\}/g,b));a.chai.markets.ui.tabs.find(".ui-tabs-nav").prepend(d);var e=a("#querybed").html(),f=e.replace(/\{\{YEAR\}\}/g,b);f=f.replace(/\{\{COUNT\}\}/g,a.chai.markets.ui.tabCounter+1).replace(/\{\{__\}\}/g,""),a.chai.markets.ui.tabs.append("<div id='"+c+"'>"+f+"</div>"),a.chai.markets.ui.tabs.tabs("refresh"),a.chai.markets.ui.tabs.tabs("option","active",a.chai.markets.ui.tabCounter),a.chai.markets.ui.tabCounter++,a.each(a('input[name^="markets_counts["]'),function(b){a(this).attr("name","markets_counts["+(b+1)+"]")})}}}(jQuery),function(a){a.chai.reports={ini:function(){a.chai.form_base.ini(),a('select[name^="property"],.property_selector').length&&a("#types").on("change",function(){a.chai.reports.set_prop_sel(a("#types").val()),a(".input_box").removeClass("showen"),a(".input_box.gen").addClass("showen"),a(".input_box [name*=value]").val("")}).trigger("change"),a("#ADD_query").on("click",function(b){b.preventDefault(),b.stopPropagation(),a(".query_item:not('#queryBed .query_item')").last().after(a("#queryBed").html()),a(".REMOVE_query").off().on("click",function(b){b.preventDefault(),b.stopPropagation(),a(this).closest(".query_item").fadeOut("150",function(){a(this).remove(),a.chai.reports.make_prop_select(),a.chai.reports.re_index_query_items()})}),a.chai.reports.make_prop_select(),a.chai.reports.re_index_query_items(),a.chai.reports.set_prop_sel(a("#types").val())}),a.chai.reports.make_prop_select(),a("#start_save_query").on("click",function(b){b.preventDefault(),b.stopPropagation(),a("#to_save_query").slideDown(),a("#start_save_query").slideUp()})},re_index_query_items:function(){a.each(a(".query_item:not('#queryBed .query_item')"),function(b){a.each(a(this).find("input:visible ,select:visible "),function(){a(this).attr("name",a(this).attr("name").split("[")[0]+"["+b+"]")})})},make_prop_select:function(){a(".property_selector").off().on("change",function(){var b=a(this).val(),c=a(this).closest(".query_item");c.find(".input_box input,.input_box select").removeAttr("name"),c.find(".input_box [name*=value]").val(""),c.find(".input_box").removeClass("showen"),c.find(".input_box."+b).addClass("showen"),c.find(".input_box:visible").length<=0&&c.find(".input_box.gen").addClass("showen"),c.find(".input_box:visible input,.input_box:visible select").attr("name","value[9999]"),a.chai.reports.re_index_query_items()})},set_prop_sel:function(b){a.each(a('form select.property_selector,form select[name="selected_properties"]'),function(){a(this).find("option").attr("selected",!1),a(this).find("optgroup").hideOptionGroup();var c=a(this).closest("select").attr("name");a("optgroup."+b+'s[data-pname="'+c+'"]').showOptionGroup()})}}}(jQuery),function(a){a.chai.trial={ini:function(){a.chai.core.util.setup_viewlog(),a.chai.form_base.ini(),a.chai.reference.ref_popup_primer(),a.chai.trial.trial_arm_primer(),a.chai.trial.start_popup_watch()},start_popup_watch:function(){a(".trial_inline_edit").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> Loading content...</span>',!0);var c=a(this).data("baseid")||a(this).closest("tr").data("baseid");a.chai.trial.trial_arm_form(c)})},trial_arm_primer:function(){a(".trial_arm_form").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> Loading content...</span>',!0),a.chai.trial.trial_arm_form()})},trial_arm_form:function(b){0===a("#trial_arm_form").length&&a("#staging").append("<div id='trial_arm_form'></div>"),a.ajax({cache:!1,url:"/center/clinical.castle",data:{skiplayout:1,id:"undefined"==typeof b?"":b,typed_ref:a('[name="typed_ref"]').val()},success:function(b){var c=a("#trial_arm_form");c.html(b),c.dialog({autoOpen:!0,resizable:!1,width:a(window).width()-50,height:a(window).height()-50,modal:!0,draggable:!1,buttons:{Cancel:function(){a(this).dialog("close")}},create:function(){a("#mess").dialog("destroy"),a("#mess").remove(),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),a.chai.clinical.ini();var b=c.find(".tab_content").hide(),d=c.find("ul.tabs li");d.addClass("tabed"),d.first().addClass("active").show(),b.first().show(),d.on("click",function(c){c.preventDefault(),c.stopPropagation();var d=a(this),e=d.find("a").attr("href");return d.hasClass("active")||(d.addClass("active").siblings().removeClass("active"),b.hide().filter(e).fadeIn()),!1}),a(".uitabs").tabs(),c.find('[name="item.trials.baseid"]').val(a('.container [name="item.baseid"]').val()),c.find("[type='submit']").on("click",function(b){var c=a(this).closest("form");c.find(":invalid").length<=0&&(b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i>Saving...</span>',!0),a.post(c.attr("action")+"?skiplayout=1&ajaxed_update=1",c.serialize(),function(){a("#mess").dialog("destroy"),a("#mess").remove();var b=a("#trial_arms.tab_content").find(".dataTable"),d=a("#trial_arms.tab_content .datagrid tbody tr").length+1;a("#trial_arms.tab_content  .datagrid tbody tr td.dataTables_empty").length&&d--,console.log("in list before add "+d);var e=[],f=c.find('[name="item.baseid"]').val();if(a("#trial_arms.tab_content .dataTable [value='"+f+"']").length<=0){var g=f+'<input type="hidden" name="trial_arms['+d+'].baseid" value="'+f+'" class="list_item drug_item">';e.push(g),e.push(c.find('[name="item.name"]').val()),e.push("-refresh for drugs-"),e.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),b.dataTable().fnAddData(e)}a.chai.core.util.build_general_removal_button(a("ul .display.datagrid.dataTable .removal")),a.chai.core.util.close_dialog_modle(a("#trial_arm_form"))}))})},close:function(){a.chai.core.util.close_dialog_modle(a("#trial_arm_form"))}}),a.chai.core.util.set_diamodle_resizing(a("#trial_arm_form"))}})}}}(jQuery),function(a){a.chai.trial_arm={ini:function(){a.chai.core.util.setup_viewlog(),a.chai.form_base.ini()}}}(jQuery),function(a){a.chai.clinical={ini:function(){a.chai.core.util.setup_viewlog(),a.chai.form_base.ini(),a.chai.drug.setup_ddi_ui(),a.chai.reference.ref_popup_primer(),a.chai.clinical.add_state(),a.each(a(".showFeildset"),function(){var b=a(this);b.buttonset(),b.find(":radio").on("change",function(){a.chai.clinical.resetFeildset(b)})}),a(".drug_inline_edit").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> Loading content...</span>',!0),a.chai.drug.drug_popupForm(a(this).closest("tr").data("baseid"))}),a(".drug_pro_add_item").on("click",function(b){b.preventDefault(),b.stopPropagation(),0===a("#drug_form").length&&a("#staging").append("<div id='drug_form'><div id='drug_list'></div></div>"),a.ajax({cache:!1,url:"/center/drugs.castle",data:{skiplayout:1,exclude:a.chai.clinical.get_current_drugList(),typed_ref:a('[name="typed_ref"]').val()},success:function(b){a("#drug_list").html(b),a("#drug_form").dialog({autoOpen:!0,resizable:!1,width:a(window).width()-50,height:a(window).height()-50,modal:!0,draggable:!1,buttons:{Cancel:function(){a(this).dialog("close")}},create:function(){a("#mess").dialog("destroy"),a("#mess").remove(),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove()},open:function(){var b=a("#drug_list #data").DataTable({bJQueryUI:!0,sPaginationType:"full_numbers",fnDrawCallback:function(){},order:[],columnDefs:[{targets:"no-sort",orderable:!1}]});a("#drug_list #data").on("draw.dt",function(){a.chai.clinical.set_drugTable_removal(),a.chai.clinical.ini_list_to_datatable()}),a.each(a("#drug_list #data thead th"),function(c){var d=a('<select><option value=""></option></select>').appendTo(a(this)).on("change",function(){var d=a(this).val();b.column(c).search(d,!1,!0,!0).draw()});b.column(c).data().unique().sort().each(function(a){d.append('<option value="'+a+'">'+a+"</option>")})}),a.chai.clinical.ini_list_to_datatable()},close:function(){a.chai.core.util.close_dialog_modle(a("#drug_form"))}}),a.chai.core.util.set_diamodle_resizing(a("#drug_form"))}})})},add_state:function(){a("#add_clinical_state").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#clinical_states.dataTable"),d=[],e=a("#clinical_states tbody tr").length+1;a.each(window.data_table_clinical_states,function(a,b){d.push(b.split("[0]").join("["+e+"]")),console.log(b.split("[0]").join("["+e+"]"))}),c.dataTable().fnAddData(d),a.chai.core.util.build_general_removal_button(a("#clinical_states tbody .removal"))})},re_index_meta_items:function(){a.each(a(".adverse_events").closest("ul").find("li[data-taxorder]"),function(b){a(this).data("taxorder",b),a.each(a(this).find("input,select:not([name=''])"),function(){a(this).attr("name",a(this).attr("name").split("[")[0]+"["+b+"]")})})},controll_meta_items:function(){a(".remove").hover(function(){a(this).removeClass("red")},function(){a(this).addClass("red")}),a(".remove").on("click",function(){var b=a(this).closest("li"),c=b.find('[name^="option"]').val();a(".adverse_events option[value='"+c+"']").removeAttr("disabled"),b.fadeOut(function(){a(this).remove()})}),a.chai.clinical.re_index_meta_items()},activate_adverse_ui:function(){a(".adverse_events").on("change",function(){var b=a(this).val(),c=a(this).find('option[value="'+b+'"]');if(!c.is(".add")){var d=a(this).closest("ul"),e=c.data("baseid"),f=c.data("content");f="undefined"!=typeof f&&""!==f?' <i class="icon-question-sign blue" title="'+f+'">':"";var g=c.data("alias"),h="none"===g?"":"required";d.append('<li data-taxorder="9999" data-name="'+c.val()+'" class="highlighted" style="padding: 15px 10px;"><i class="icon-remove-circle red right remove"></i><label>'+c.text()+f+'</label><input type="'+("none"===g?"hidden":"text")+'" name="value[9999]" id="" '+h+' value=""/><input type="hidden" name="option_key[9999]" value="'+e+'" /></li>'),c.attr("disabled",!0),a(this).val(""),a.chai.clinical.controll_meta_items(),a.chai.clinical.re_index_meta_items(),a.chai.core.util.make_maskes(),a.chai.core.util.unhighlight()}}),a.chai.clinical.controll_meta_items()},resetFeildset:function(b){b.find(":radio").next("label").find("i").removeClass("icon-check-empty").removeClass("icon-check"),b.find(":radio").not(":checked").next("label").find("i").addClass("icon-check-empty"),b.find(":radio:checked").next("label").find("i").addClass("icon-check");var c=b.closest("fieldset").find("ul");c.is(".open")?c.hide("fast",function(){c.removeClass("open")}):c.show("fast",function(){if(c.addClass("open"),a("#fed_block").find("ul").is(".open")&&a("#fasting_block").find("ul").is(".open")){var b;b=a(c.closest("fieldset").is("#fed_block")?"#fasting_block":"#fed_block"),b.find("ul").hide("fast",function(){b.find("ul").removeClass("open"),b.find('.showFeildset :radio[value="yes"]').removeAttr("checked"),b.find('.showFeildset :radio[value="yes"]').next("label").removeClass("ui-state-active"),b.find('.showFeildset :radio[value="yes"]').next("label").find("i").addClass("icon-check-empty").removeClass("icon-check"),b.find('.showFeildset :radio[value="no"]').next("label").find("i").addClass("icon-check").removeClass("icon-check-empty"),b.find('.showFeildset :radio[value="no"]').next("label").addClass("ui-state-active"),b.find('.showFeildset :radio[value="no"]').attr("checked","checked")})}})},set_drugTable_removal:function(){a.chai.core.util.build_general_removal_button(a("#Drugdata .removal"))},ini_list_to_datatable:function(){a(".additem").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#drug_list #data").dataTable(),d=a(this),e=d.closest("tr"),f=e.data("baseid"),g=a("#drug_products .datagrid tbody tr").length+1;a("#drug_products .datagrid tbody tr td.dataTables_empty").length&&g--,console.log("in list before add "+g);var h=e.find("td").length,i=[],j=e.find("td:first").text()+'<input type="hidden" name="drugs['+g+'].baseid" data-baseid="'+f+'" value="'+f+'" class="drug_item list_item"/>';i.push(j);for(var k=1;h-1>k;k++)console.log("td "+k),i.push(e.find("td:eq("+k+")").text());i.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),a("#drug_products .datagrid").dataTable().fnAddData(i),e.fadeOut("75",function(){c.fnDeleteRow(c.fnGetPosition(e.get(0)))}),a("#drug_form").append("<span class='dialog_message ui-state-highlight'>Added to this "+a("#header_title").text()+"</span>"),setTimeout(function(){a(".dialog_message").fadeOut("500")},"1000"),a.chai.clinical.set_drugTable_removal(),a("#drug_list #data").on("draw.dt",function(){a.chai.clinical.set_drugTable_removal(),a.chai.clinical.ini_list_to_datatable()}),a.chai.clinical.ini_list_to_datatable(),a.chai.core.util.autoSaver(),console.log("in list after add "+a("#drug_products .datagrid tbody tr").length)})},get_current_drugList:function(){var b="";return a.each(a("#drug_products tbody tr"),function(){b+=(""===b?"":",")+a(this).data("baseid")}),b}}}(jQuery),function(a){a.chai.drug={ini:function(){a.chai.core.util.setup_viewlog(),a.chai.form_base.ini(),a("select[name*='inactive_ingredients[]']").on("change",function(){var b="";a.each(a(this).find(":selected"),function(c){b+=(c>0?",":"")+a(this).val()}),a("[name$='inactive_ingredients']").val(b)}),a(".claim_item").on("keyup",function(){var b="";a.each(a(".claim_item"),function(){b+=(""===b?"":":")+a(this).val()}),a("#item_label_claim").val(b),a("#CLAIM").text(b)}),a.chai.markets.ini(),a.chai.trial.trial_arm_primer(),a.each(a(".table_radios:not(.ui-buttonset)"),function(){a(this).buttonset()}),a.chai.drug.add_lmic(),a.chai.drug.setup_ddi_ui()},add_lmic:function(){a("#add_lmic").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#LMICdata").find(".dataTable"),d=[],e=a("#LMICdata tbody tr").length+1;d.push('<input type="hidden" name="lmics['+e+'].id" value="0"/><input type="text" placeholder="label claim amount" name="lmics['+e+'].amount"/>'),d.push('<label for="radio'+e+'-1">Yes</label><input id="radio'+e+'-1" type="radio" name="lmics['+e+'].lmic_1l" value="yes" /><label for="radio'+e+'-2">No</label><input id="radio'+e+'-2" type="radio" name="lmics['+e+'].lmic_1l" value="no" />'),d.push('<label for="radio'+e+'-3">Yes</label><input id="radio'+e+'-3" type="radio" name="lmics['+e+'].lmic_2l" value="yes" /><label for="radio'+e+'-4">No</label><input id="radio'+e+'-4" type="radio" name="lmics['+e+'].lmic_2l" value="no" />'),d.push('<label for="radio'+e+'-5">Yes</label><input id="radio'+e+'-5" type="radio" name="lmics['+e+'].lmic_3l" value="yes" /><label for="radio'+e+'-6">No</label><input id="radio'+e+'-6" type="radio" name="lmics['+e+'].lmic_3l" value="no" />'),d.push('<label for="radio'+e+'-7">Yes</label><input id="radio'+e+'-7" type="radio" name="lmics['+e+'].tbd" value="yes" /><label for="radio'+e+'-8">No</label><input id="radio'+e+'-8" type="radio" name="lmics['+e+'].tbd" value="no" />'),d.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),c.dataTable().fnAddData(d),a('#LMICdata table tr [type="radio"]').closest("td:not(.ui-buttonset)").addClass("table_radios"),a.each(a(".table_radios:not(.ui-buttonset)"),function(){a(this).buttonset()}),a.chai.core.util.build_general_removal_button(a("#LMICdata tbody .removal")),a.chai.drug.add_lmic()})},apply_ddi_removal:function(){a.chai.core.util.build_general_removal_button(a("#ddi tbody .removal"))},setup_ddi_ui:function(){a.chai.drug.apply_ddi_removal(),a("#drug_interaction").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#ddi").find(".dataTable"),d=[],e=a("#ddi_drug_product").length>0,f=a("#ddi tbody select").length,g="interactions["+f+"]",h="";e&&(g="interactions["+f+"]",h='<input type="hidden" name="'+g+'.arm.baseid" value="'+a("[name='item.baseid']").val()+'"/><select name="'+g+'.drug" id="drpr_'+f+'"><option value="">Select</option></select>',d.push(h)),h='<input type="hidden" name="'+g+'.id" value="0"/><select name="'+g+'.substance"  id="ddi_only_'+f+'"><option value="">Select</option></select>',d.push(h),h='<select name="'+g+'.yes_no"><option value="yes">Yes</option><option value="no">No</option></select>',d.push(h),h='<input type="text" name="'+g+'.dose_amount" value="" style="width:100%"/>',d.push(h),d.push('<textarea placeholder="Describe the interaction between the two drugs" name="'+g+'.descriptions"  rows="1"></textarea>'),d.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),c.dataTable().fnAddData(d),e&&a.getJSON("/center/drugs.castle?json=true&callback=?",function(b){a.each(b,function(b,c){a("[data-baseid='"+c.baseid+"']").length>0&&a("#drpr_"+f).append("<option value='"+c.baseid+"' data-baseid='"+c.baseid+"' data-name='"+c.name+"' data-label_claim='"+c.label_claim+"' data-form='"+c.form+"' data-manufacturer='"+c.manufacturer+"'  >"+c.form+" -- "+c.name+" ( "+c.manufacturer+" | "+c.label_claim+" )</option>")})}),a.getJSON("/center/substances.castle?json=true&callback=?",function(b){a("#ddi_only_"+f).append(function(){var c="";return c+='<optgroup label="Drug Substances">',a.each(b,function(a,b){"yes"!==b.ddi&&(c+="<option value='"+b.baseid+"' data-baseid='"+b.baseid+"' data-name='"+b.name+"' data-abbreviated='"+b.abbreviated+"'   >"+b.name+" ( "+b.abbreviated+" )</option>")}),c+="</optgroup>",c+='<optgroup label="DDI ONLY Substances">',a.each(b,function(a,b){"yes"===b.ddi&&(c+="<option value='"+b.baseid+"' data-baseid='"+b.baseid+"' data-name='"+b.name+"' data-abbreviated='"+b.abbreviated+"'   >"+b.name+" ( "+b.abbreviated+" )</option>")}),c+="</optgroup>"})}),a.chai.drug.apply_ddi_removal()})},drug_popupForm:function(b){0===a("#drug_form").length&&a("#staging").append("<div id='drug_form'></div>"),a.ajax({cache:!1,url:"/center/drug.castle",data:{skiplayout:1,id:"undefined"==typeof b?"":b,typed_ref:a('[name="typed_ref"]').val()},success:function(b){var c=a("#drug_form");c.html(b),c.dialog({autoOpen:!0,resizable:!1,width:a(window).width()-50,height:a(window).height()-50,modal:!0,draggable:!1,buttons:{Cancel:function(){a(this).dialog("close")}},create:function(){a("#mess").dialog("destroy"),a("#mess").remove(),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),a.chai.drug.ini();var b=c.find(".tab_content").hide(),d=c.find("ul.tabs li");d.addClass("tabed"),d.first().addClass("active").show(),b.first().show(),d.on("click",function(c){c.preventDefault(),c.stopPropagation();var d=a(this),e=d.find("a").attr("href");return d.hasClass("active")||(d.addClass("active").siblings().removeClass("active"),b.hide().filter(e).fadeIn()),!1}),a(".uitabs").tabs(),c.find("[type='submit']").on("click",function(b){var c=a(this).closest("form");c.find(":invalid").length<=0&&(b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i>Saving...</span>',!0),a.post(c.attr("action")+"?skiplayout=1&ajaxed_update=1",c.serialize(),function(){a("#mess").dialog("destroy"),a("#mess").remove();var b=a("#drug_products.tab_content").find(".dataTable"),d=a("#drug_products.tab_content .datagrid tbody tr").length+1;a("#drug_products.tab_content  .datagrid tbody tr td.dataTables_empty").length&&d--,console.log("in list before add "+d);var e=[],f=c.find('[name="item.baseid"]').val();if(a("#drug_products.tab_content .dataTable [value='"+f+"']").length<=0){var g=c.find('[name="item.dose_form"]').val()+'<input type="hidden" name="drugs['+d+'].baseid" value="'+f+'" class="list_item drug_item">';e.push(g),e.push(c.find('[name="item.label_claim"]').val()),e.push(c.find("header h3 > em").text()),e.push("-refresh for drugs-"),e.push(c.find("#manufacturer_info").text()),e.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),b.dataTable().fnAddData(e)}a.chai.core.util.build_general_removal_button(a("ul .display.datagrid.dataTable .removal")),a.chai.core.util.close_dialog_modle(a("#drug_form"))}))})},close:function(){a.chai.core.util.close_dialog_modle(a("#drug_form"))}}),a.chai.core.util.set_diamodle_resizing(a("#drug_form"))}})}}}(jQuery),function(a){a.chai.substance={ini:function(){a.chai.core.util.setup_viewlog(),a.chai.form_base.ini(),a("#ddiradio").buttonset(),a("#ddiradio :radio").on("change",function(){a("#ddiradio :radio").next("label").find("i").removeClass("icon-check-empty").removeClass("icon-check"),a("#ddiradio :radio").not(":checked").next("label").find("i").addClass("icon-check-empty"),a("#ddiradio :radio:checked").next("label").find("i").addClass("icon-check")}),a("#add_substance_salt").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#Saltdata.dataTable"),d=[],e=a("#Saltdata tbody select").length,f='<input type="hidden" name="salts['+e+'].id" value="0"/><select name="salts['+e+'].is_salt"><option value="Yes">Yes</option><option value="No">No</option></select>';d.push(f),d.push('<input type="text" value="" name="salts['+e+'].form"/>'),d.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),c.dataTable().fnAddData(d),a.chai.core.util.build_general_removal_button(a("#Saltdata tbody .removal"))}),a("#add_substance_prodrug").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a("#Prodrugdata.dataTable"),d=[],e=a("#Prodrugdata tbody select").length,f='<input type="hidden" name="prodrugs['+e+'].id" value="0"/>';d.push(f+'<input type="text" value="" name="prodrugs['+e+'].active_moiety"/>'),d.push('<input type="text" value="" name="prodrugs['+e+'].active_metabolites"/>'),d.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),c.dataTable().fnAddData(d),a.chai.core.util.build_general_removal_button(a("#Prodrugdata tbody .removal"))})}}}(jQuery),function(a){a.chai.reference={ini:function(){a.chai.form_base.ini(),a.chai.reference.int_file()},int_file:function(){a("#load_file").on("click",function(){a(".load_file").toggleClass("active"),a(".load_file input").removeAttr("required"),a(".load_file:visible input").attr("required",!0)})},ref_popup_primer:function(){var b='<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i> Loading content...</span>';a(".ref_form").on("click",function(c){c.preventDefault(),c.stopPropagation(),a.chai.core.util.popup_message(b,!0);var d=[];a.chai.reference.add_item_popup(d,["new","list"])}),a(".ref_inline_edit").on("click",function(c){c.preventDefault(),c.stopPropagation(),a.chai.core.util.popup_message(b,!0),a.chai.reference.ref_popup_form(a(this).closest("tr").data("baseid"))})},add_item_popup:function(b){0===a("#ref_form").length&&a("#staging").append("<div id='ref_form'><div id='drug_list'></div><div id='drug_item'></div></div>");var c="";a.ajax({cache:!1,url:"/center/references.castle",data:{skiplayout:1,exclude:b,typed_ref:a('[name="typed_ref"]').val()},success:function(b){a("#drug_list").html(b),c+="<a href='#drug_list' id='drug_list_tab' class='popuptab button med active'>List</a>",a.ajax({cache:!1,url:"/center/reference.castle",data:{skiplayout:1,typed_ref:a('[name="typed_ref"]').val()},success:function(b){a("#drug_item").html(b),c+="<a href='#drug_item' id='drug_item_tab' class='popuptab button med'>New</a>",a("#ref_form").dialog({autoOpen:!0,resizable:!1,width:a(window).width()-50,height:a(window).height()-50,modal:!0,draggable:!1,buttons:{Cancel:function(){a(this).dialog("close")}},create:function(){a("#mess").dialog("destroy"),a("#mess").remove(),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),a("#ref_form").closest(".ui-dialog").find(".ui-dialog-title").append(c),a("#drug_item").hide(),a.chai.core.util.make_popup_datatable("reference"),a(".popuptab").off().on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(".popuptab.active").attr("href");a(c).hide(),a(".popuptab.active").removeClass("active"),a(this).addClass("active"),c=a(this).attr("href"),a(c).show()}),a.chai.reference.ini_inline_form(a("#ref_form"))},close:function(){a.chai.core.util.close_dialog_modle(a("#ref_form")),a.chai.core.util.last_datatable=null}}),a.chai.core.util.set_diamodle_resizing(a("#ref_form"))}})}})},ref_popup_form:function(b){0===a("#ref_form").length&&a("#staging").append("<div id='ref_form'></div>"),a.ajax({cache:!1,url:"/center/reference.castle",data:{skiplayout:1,id:"undefined"==typeof b?"":b,typed_ref:a('[name="typed_ref"]').val()},success:function(b){var c=a("#ref_form");c.html(b),c.dialog({autoOpen:!0,resizable:!1,width:a(window).width()-50,height:a(window).height()-50,modal:!0,draggable:!1,buttons:{Cancel:function(){a(this).dialog("close")}},create:function(){a("#mess").dialog("destroy"),a("#mess").remove(),a("body").css({overflow:"hidden"}),a(".ui-dialog-buttonpane").remove(),a.chai.reference.ini_inline_form(c)},close:function(){a.chai.core.util.close_dialog_modle(a("#ref_form"))}}),a.chai.core.util.set_diamodle_resizing(a("#ref_form"))}})},ini_inline_form:function(b){a.chai.reference.int_file(),b.find('[name="item.trials.baseid"]').val(a('.container [name="item.baseid"]').val()),b.find("[type='submit']").on("click",function(b){var c=a(this).closest("form");c.find(":invalid").length<=0&&(b.preventDefault(),b.stopPropagation(),a.chai.core.util.popup_message('<span style="font-size: 28px;"><i class="icon-spinner icon-spin icon-large"></i>Saving...</span>',!0),a.post(c.attr("action")+"?skiplayout=1&ajaxed_update=1",c.serialize(),function(){a("#mess").dialog("destroy"),a("#mess").remove();var b=a("#trial_arms.tab_content").find(".dataTable"),d=a("#trial_arms.tab_content .datagrid tbody tr").length+1;a("#trial_arms.tab_content  .datagrid tbody tr td.dataTables_empty").length&&d--,console.log("in list before add "+d);var e=[],f=c.find('[name="item.baseid"]').val();if(0>=f){var g=f+'<input type="hidden" name="references['+d+'].baseid" value="'+f+'" class="drug_item">';e.push(g),e.push(c.find('[name="item.name"]').val()),e.push("-refresh for drugs-"),e.push('<a href="#" class="button xsmall crimson defocus removal"><i class="icon-remove" title="Remove"></i></a>'),b.dataTable().fnAddData(e)}a.chai.core.util.build_general_removal_button(a("ul .display.datagrid.dataTable .removal")),a("#ref_form").dialog("destroy"),a("#ref_form").remove()}))})}}}(jQuery),function(a){a.chai.ready=function(b){a(document).ready(function(){var c,d;return d=window.location.pathname,c=d.substring(d.lastIndexOf("/")+1),c=c.substring(0,c.lastIndexOf(".")),"undefined"!=typeof a.chai[c]?(a.chai[c].ini(),a.chai.core.util.setup_ref_copy()):(a.chai.core.util.make_dataTables(),a.chai.core.util.set_up_list_deletion()),b})},a.chai.ini()}(jQuery);